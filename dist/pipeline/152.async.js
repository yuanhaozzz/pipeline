"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[152],{53515:function(pn,Mr,u){u.d(Mr,{Z:function(){return Kn}});var Gr=u(15009),M=u.n(Gr),Yr=u(97857),_=u.n(Yr),Kr=u(99289),we=u.n(Kr),$e=u(5574),ue=u.n($e),c=u(62435),Vr=u(68872),Te=u(94060),A=u(96456),a=u(81182),me=u(84567),Ae=u(74877),qe=u(70732),hr=u(88026),e=u(86074),tn=Te.Z.Option,ln=A.Z.TextArea,Wr={labelCol:{span:3},wrapperCol:{span:18}},zr=function(d,n){var s,v=d.data,O=d.type,ae=(0,c.useReducer)(function($){return $+1},0),m=ue()(ae,2),w=m[1],D=(0,c.useState)({}),g=ue()(D,2),V=g[0],te=g[1],ie=(0,Ae.DP)(),pe=ie.pipelineId,Ze=ie.from,he=a.Z.useForm(),x=ue()(he,1),K=x[0],P=(0,hr.useModel)("@@initialState"),le=P.initialState,T=le.currentUser,b=T===void 0?{}:T;(0,c.useImperativeHandle)(n,function(){return{getFormValue:h}}),(0,c.useEffect)(function(){E()},[v]);var E=function(){var Q=["description","label","timer_info","hookURL","repo_name"];K.setFieldValue("name",v.name),K.setFieldValue("from",0),K.setFieldValue("repo_url",v.setting.git_info.repo_url),K.setFieldValue("is_public",v.setting.is_public),Q.forEach(function(de){K.setFieldValue(de,v.setting[de])});var W=location.pathname;W.includes("/workflowService")&&Ze==="add"&&K.setFieldValue("label","\u6D41\u7A0B\u670D\u52A1"),te(_()(_()({},V),{},{is_public:v.is_public}))},h=function(){var $=we()(M()().mark(function Q(){var W;return M()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,K.validateFields();case 2:return W=se.sent,se.abrupt("return",W);case 4:case"end":return se.stop()}},Q)}));return function(){return $.apply(this,arguments)}}(),k=function(Q){console.log(Q)},G=function(){var Q=location.pathname;if(Q.includes("/workflowService")&&Ze==="add")return!0};return(0,e.jsx)("div",{className:"flex-center modify-form-base-info",children:(0,e.jsxs)(a.Z,_()(_()({},Wr),{},{form:K,name:"control-hooks",onFinish:k,className:"base-info-form",disabled:!(0,Ae.Hb)(b,v==null?void 0:v.creator_user_id)||O!==1,children:[(0,e.jsx)(a.Z.Item,{name:"from",label:""}),(0,e.jsx)(a.Z.Item,{name:"name",label:"\u6D41\u6C34\u7EBF\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D41\u6C34\u7EBF\u540D\u79F0"}],children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165\u6D41\u6C34\u7EBF\u540D\u79F0",maxLength:100})}),(0,e.jsx)(a.Z.Item,{name:"description",label:"\u63CF\u8FF0",className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:(s=v.setting)===null||s===void 0?void 0:s.description,hideTitle:!0,isSimple:!0,disabled:!(0,Ae.Hb)(b,v==null?void 0:v.creator_user_id)||O!==1})}),(0,e.jsx)(a.Z.Item,{name:"label",label:"\u6807\u7B7E",children:(0,e.jsx)(Te.Z,{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u6807\u7B7E",disabled:G(),options:[{value:"\u6D41\u7A0B\u670D\u52A1",label:"\u6D41\u7A0B\u670D\u52A1"},{value:"\u8D28\u91CF\u95E8\u7981",label:"\u8D28\u91CF\u95E8\u7981"}]})}),(0,e.jsx)(a.Z.Item,{name:"is_public",label:"\u53EF\u89C1\u8303\u56F4",valuePropName:"checked",children:(0,e.jsx)(me.Z,{children:"\u6240\u6709\u4EBA\u53EF\u89C1"})})]}))})},on=(0,c.forwardRef)(zr),Ne=u(78045);function L(i,d){for(var n=[],s=0;s<i;s++)n.push({value:(s+1)*30,label:s+1+"\u4E2A\u6708"});return n}var Qr=L(12),Xr=u(13769),Jr=u.n(Xr),_r=u(19632),q=u.n(_r),qr=u(47221),nr=u(77683),tr=u(57132),ze=u(80882),Me=u(3089),ir=u(24969),lr=u(34084),Ar=u(83056),Dr=["key","name"],er=qr.Z.Panel,Ke={labelCol:{span:4},wrapperCol:{span:18}};function gr(i,d){var n=i.type,s=i.data,v=i.disabled,O=(0,c.useState)([]),ae=ue()(O,2),m=ae[0],w=ae[1],D=a.Z.useForm(),g=ue()(D,1),V=g[0];(0,c.useImperativeHandle)(d,function(){return{getFormValue:ie,initForm:te}});var te=function(){var T=we()(M()().mark(function b(){var E,h,k,G,$,Q,W,de,se,Se,Pe,C,Le;return M()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:E=(s==null?void 0:s.setting)||{},h=E.trigger_type,k=E.hook_url,G=E.include_branch,$=E.magic_comment,Q=E.file_path,W=E.repo_name,de=E.exclude_branch,se=E.hook_from,Se=E.trigger_list,Pe=Se===void 0?[]:Se,C=Pe,Le=[{trigger_type:h.includes("HOOK")?"hook":"manual",hook_from:se||h.includes("GITLAB")?"gitlab_ee":"gerrit",hook_url:"".concat(location.protocol,"//").concat(location.host).concat(k),repo_name:W,trigger_comment:$,include_branch:G,file_path:Q,exclude_branch:de}],C.length>0&&(Le=C),V.setFieldValue("trigger",Le),w(q()(Le).map(function(t){return t.active=!1,t}));case 6:case"end":return B.stop()}},b)}));return function(){return T.apply(this,arguments)}}(),ie=function(){var T=we()(M()().mark(function b(){var E;return M()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,V.validateFields();case 2:return E=k.sent,k.abrupt("return",E);case 4:case"end":return k.stop()}},b)}));return function(){return T.apply(this,arguments)}}(),pe=function(b){},Ze=function(b,E,h){var k=V.getFieldValue(["trigger",h,"hook_from"])||"gitlab_ee",G=k.includes("gerrit")?"gerrit":"gitlabee";return(0,e.jsx)(lr.Z,{name:[E,"repo_name"],label:"",repoType:G,repoChange:pe})},he=[{value:"gerrit",label:"Gerrit"},{value:"gitlab_ee",label:"Gitlab-EE"},{value:"gitlab_ce",label:"Gitlab-CE"}],x=function(b,E,h){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var G=V.getFieldValue(["trigger",b,"trigger_type"]);return G==="manual"?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"hook_from"],label:"",style:{marginBottom:"5px"},initialValue:"gerrit",children:(0,e.jsx)(Ne.ZP.Group,{onChange:function(){w(q()(m)),V.validateFields()},options:he,optionType:"button",buttonStyle:"solid"})}))}}),(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var G=V.getFieldValue(["trigger",b,"trigger_type"]),$=V.getFieldValue(["trigger",b,"hook_from"])||"gitlab_ee";if(G==="hook"){var Q;return(0,e.jsxs)(e.Fragment,{children:[!$.includes("gitlab")&&(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"\u4ED3\u5E93\u540D\u79F0"}),Ze(E,h,b)]}),$.includes("gitlab")&&(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"Webhook URL\uFF08\u8BF7\u590D\u5236\u8BE5 Hook \u7684\u5730\u5740\uFF0C\u7C98\u8D34\u5230 Gitlab \u7684 Webhook \u91CC\u9762\uFF09"}),(0,e.jsxs)("div",{className:"flex-space-between",children:[(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"hook_url"],noStyle:!0,initialValue:"".concat(location.protocol,"//").concat(location.host).concat(s==null||(Q=s.setting)===null||Q===void 0?void 0:Q.hook_url),children:(0,e.jsx)(A.Z,{disabled:!0})})),(0,e.jsx)(a.Z.Item,{style:{width:"4%"},children:(0,e.jsx)("div",{onClick:function(){return(0,Ae.zp)("".concat(location.protocol,"//").concat(location.host).concat((s==null?void 0:s.setting.hook_url)||""))},children:(0,e.jsx)(tr.Z,{style:{fontSize:"20px",color:"#63656e",cursor:"pointer",marginLeft:"10px"}})})})]})]}),(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"\u5206\u652F\u540D\u79F0"}),(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"include_branch"],label:"",children:(0,e.jsx)(A.Z,{placeholder:"\u6307\u5B9A\u5206\u652F\u540D\u79F0\u6216\u8005\u6B63\u5219\u8868\u8FBE\u5F0F\u5339\u914D\u8981\u89E6\u53D1\u7684\u5206\u652F"})}))]}),$.includes("gitlab")&&(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"Comments \u5173\u952E\u5B57"}),(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"trigger_comment"],label:"",children:(0,e.jsx)(A.Z,{placeholder:"\u76D1\u542C Gitlab Merge Request \u7684\u8BC4\u8BBA\u64CD\u4F5C\uFF0C\u4E3A\u7A7A\u65F6\u4E0D\u4F1A\u89E6\u53D1\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F"})}))]}),!$.includes("gitlab")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"Comments \u5173\u952E\u5B57"}),(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"trigger_comment"],label:"",children:(0,e.jsx)(A.Z,{placeholder:"\u76D1\u542C Gerrit Patchset \u8BC4\u8BBA\u64CD\u4F5C\uFF0C\u4E3A\u7A7A\u65F6\u4E0D\u4F1A\u89E6\u53D1\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F"})}))]}),(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"\u6587\u4EF6\u8DEF\u5F84"}),(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"file_path"],label:"",children:(0,e.jsx)(A.Z,{placeholder:"\u591A\u4E2A\u6587\u4EF6\u9017\u53F7\u5206\u9694",disabled:!0})}))]})]}),(0,e.jsxs)(a.Z.Item,{label:" ",colon:!1,style:{marginBottom:"14px"},children:[(0,e.jsx)("p",{style:{marginBottom:"5px"},children:"\u6392\u9664\u4EE5\u4E0B\u76EE\u6807\u5206\u652F"}),(0,e.jsx)(a.Z.Item,_()(_()({},E),{},{name:[h,"exclude_branch"],label:"",children:(0,e.jsx)(A.Z,{placeholder:"\u591A\u4E2A\u5206\u652F\u9017\u53F7\u5206\u9694\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",disabled:!0})}))]})]})}return(0,e.jsx)(e.Fragment,{})}})]})},K=function(b,E,h){var k=[],G=0,$=0;if(b.forEach(function(Q,W){var de=V.getFieldValue(["trigger",W,"trigger_type"]);de==="manual"&&(k.push(W),G+=1),de==="hook"&&($+=1)}),k.includes(h)){if($>0)return Promise.reject("\u5DF2\u914D\u7F6E Hook \u89E6\u53D1\uFF0C\u65E0\u6CD5\u914D\u7F6E\u624B\u52A8");if(G>1)return Promise.reject("\u624B\u52A8\u89E6\u53D1\u5DF2\u5B58\u5728")}return Promise.resolve()},P=function(b,E,h,k){b.stopPropagation(),E(k),m.splice(h,1),w(q()(m)),V.validateFields()},le=function(b,E,h,k){var G,$=V.getFieldValue(["trigger",h,"trigger_type"]),Q=V.getFieldValue(["trigger",h,"hook_from"])||"gerrit";return(0,e.jsxs)("div",{className:"header flex-space-between",onClick:function(){m[h].active=!m[h].active,w(q()(m))},children:[(0,e.jsxs)("div",{className:"flex-start",children:[(0,e.jsx)(ze.Z,{className:"common-animation-arrow ".concat(((G=m[h])===null||G===void 0?void 0:G.active)&&"common-animation-arrow-active")}),"\xA0\xA0",(0,Ar.Fo)($,Q),"\xA0\xA0",(0,Ar.MQ)($,Q)]}),n===1&&k.length>1&&(0,e.jsx)(Me.Z,{onClick:function(de){return P(de,b,h,E)}})]})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(a.Z,_()(_()({},Ke),{},{form:V,name:"control-hooks",className:"run-config-form",disabled:v,children:[(0,e.jsx)(a.Z.Item,{name:"from",label:"",initialValue:1,noStyle:!0}),(0,e.jsx)(a.Z.Item,{name:"",label:"\u89E6\u53D1\u65B9\u5F0F",className:"flow-run-config-triggerType",children:(0,e.jsx)(a.Z.List,{name:"trigger",children:function(b,E){var h=E.add,k=E.remove;return(0,e.jsxs)(e.Fragment,{children:[b.map(function(G,$){var Q,W=G.key,de=G.name,se=Jr()(G,Dr);return(0,e.jsxs)("div",{className:"trigger-container",children:[le(k,de,$,b),(0,e.jsxs)("div",{className:"content",style:{display:(Q=m[$])!==null&&Q!==void 0&&Q.active?"block":"none"},children:[(0,e.jsx)(a.Z.Item,_()(_()({},se),{},{name:[de,"trigger_type"],initialValue:"manual",rules:[{required:!0,message:""},{validator:function(Pe,C){return K(b,C,$)}}],style:{marginBottom:"8px"},children:(0,e.jsxs)(Ne.ZP.Group,{onChange:function(){w(q()(m)),V.validateFields()},children:[(0,e.jsx)(Ne.ZP,{value:"manual",children:"\u624B\u52A8\u89E6\u53D1"}),(0,e.jsx)(Ne.ZP,{value:"hook",children:"Hook \u89E6\u53D1"})]})})),x($,se,de)]})]})}),n===1&&(0,e.jsx)(a.Z.Item,{children:(0,e.jsx)(nr.ZP,{type:"dashed",onClick:function(){h(),m.push({active:!0}),setTimeout(function(){w(q()(m)),V.validateFields()},100)},block:!0,icon:(0,e.jsx)(ir.Z,{}),children:"\u65B0\u589E\u89E6\u53D1\u65B9\u5F0F"})})]})}})})]}))})}var sr=(0,c.forwardRef)(gr),en=Te.Z.Option,Er=A.Z.TextArea,dr={labelCol:{span:4},wrapperCol:{span:18}},xr=function(d,n){var s=d.data,v=d.type,O=a.Z.useForm(),ae=ue()(O,1),m=ae[0],w=(0,hr.useModel)("@@initialState"),D=w.initialState,g=D.currentUser,V=g===void 0?{}:g,te=(0,c.useRef)({});(0,c.useImperativeHandle)(n,function(){return{getFormValue:pe}}),(0,c.useEffect)(function(){ie()},[s]);var ie=function(){var x,K=["pipeline_env"];if(m.setFieldValue("run_lock_type",s.run_lock_type),m.setFieldValue("from",1),m.setFieldValue("enabled",s.setting.enabled),m.setFieldValue("exclude_branch",s.setting.exclude_branch),((x=s.setting)===null||x===void 0||(x=x.extra_data)===null||x===void 0?void 0:x.isExpandAll)!==void 0){var P;m.setFieldValue("isExpandAll",(P=s.setting)===null||P===void 0||(P=P.extra_data)===null||P===void 0?void 0:P.isExpandAll)}m.setFieldValue("history_limit",s.setting.history_limit||90),K.forEach(function(le){m.setFieldValue(le,s.setting[le])}),te.current.initForm()},pe=function(){var he=we()(M()().mark(function x(){var K,P;return M()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,m.validateFields();case 2:return K=T.sent,T.next=5,te.current.getFormValue();case 5:return P=T.sent,T.abrupt("return",_()(_()({},K),{},{trigger_list:P.trigger}));case 7:case"end":return T.stop()}},x)}));return function(){return he.apply(this,arguments)}}(),Ze=function(x){console.log(x)};return(0,e.jsx)("div",{className:"flex-center modify-form-run-config",children:(0,e.jsxs)(a.Z,_()(_()({},dr),{},{form:m,name:"control-hooks",onFinish:Ze,className:"run-config-form",disabled:!(0,Ae.Hb)(V,s==null?void 0:s.creator_user_id)||v!==1,children:[(0,e.jsx)(a.Z.Item,{name:"from",label:""}),(0,e.jsx)(a.Z.Item,{name:"enabled",label:"\u662F\u5426\u542F\u7528\u6D41\u6C34\u7EBF",rules:[{required:!0,message:"\u662F\u5426\u5E76\u884C"}],children:(0,e.jsxs)(Ne.ZP.Group,{disabled:!0,children:[(0,e.jsx)(Ne.ZP,{value:!0,children:"\u662F"}),(0,e.jsx)(Ne.ZP,{value:!1,children:"\u5426"})]})}),(0,e.jsx)(a.Z.Item,{name:"run_lock_type",label:"\u662F\u5426\u5E76\u884C",children:(0,e.jsxs)(Ne.ZP.Group,{name:"run_lock_type",children:[(0,e.jsx)(Ne.ZP,{value:"MULTIPLE",children:"\u662F"}),(0,e.jsx)(Ne.ZP,{value:"SINGLE",children:"\u5426"})]})}),(0,e.jsx)(a.Z.Item,{name:"isExpandAll",label:"\u9ED8\u8BA4\u5C55\u5F00\u6240\u6709 Task",initialValue:!0,colon:!0,children:(0,e.jsxs)(Ne.ZP.Group,{children:[(0,e.jsx)(Ne.ZP,{value:!0,children:"\u662F"}),(0,e.jsx)(Ne.ZP,{value:!1,children:"\u5426"})]})}),(0,e.jsx)(a.Z.Item,{name:"history_limit",label:"\u8FD0\u884C\u8BB0\u5F55\u4FDD\u5B58\u671F\u9650",children:(0,e.jsx)(Te.Z,{options:Qr,style:{width:"80px"}})}),(0,e.jsx)(sr,{form:m,type:v,data:s,disabled:!(0,Ae.Hb)(V,s==null?void 0:s.creator_user_id)||v!==1,ref:te})]}))})},Nr=(0,c.forwardRef)(xr),cr=u(61781),Rr=u(85418),kr=u(29751),jr=u(90814),Sr=u(52745),Pr=u(42952),Qe=[{label:"\u5B57\u7B26\u4E32",value:"string"},{label:"\u5E03\u5C14\u503C",value:"bool"},{label:"\u5355\u9009\u6846",value:"choose"},{label:"\u591A\u9009\u6846",value:"multiple"},{label:"\u65F6\u95F4\u70B9",value:"date"}],xe=["CI_TRIGGER_REF","ref","CI_TRIGGER_SHA","sha","CI_TRIGGER_REPO_URL","git_url","CI_TRIGGER_PATCHSET","patchset","CI_TRIGGER_TAG","tag","SOURCE_BRANCH","source_branch","SOURCE_COMMIT_ID","source_commit_id","TARGET_BRANCH","target_branch","TARGET_COMMIT_ID","target_commit_id"],ar=u(30381),Ce=u.n(ar),Ge=u(74330),Re=u(32983),Fr=u(11238),Tr=function(d){return(0,Fr.ZP)("/api/pipeline/variables/commit",{method:"get",params:d})},or=u(23279),rr=u.n(or),ur=Te.Z.Option;function yr(i,d){var n=i.label,s=i.name,v=i.initialValue,O=i.repoType,ae=i.required,m=i.message,w=i.repoId,D=i.branch,g=i.repoName,V=i.className,te=i.style,ie=i.isBranchValue,pe=i.help,Ze=pe===void 0?"":pe,he=i.commitChange,x=he===void 0?function(){}:he,K=i.placeholder,P=i.disabled,le=(0,c.useState)(!1),T=ue()(le,2),b=T[0],E=T[1],h=(0,c.useState)(!1),k=ue()(h,2),G=k[0],$=k[1],Q=(0,c.useState)([]),W=ue()(Q,2),de=W[0],se=W[1],Se=(0,c.useRef)(null),Pe=function(){Ye()},C=(0,c.useCallback)(rr()(Pe,200),[w,D,g,1e3]);(0,c.useEffect)(function(){return C(),C.cancel},[w,D,g,C]),(0,c.useImperativeHandle)(d,function(){return{getData:Ye,setOptionsData:Le}});var Le=function(X){se(X)},Ye=function(){var N=we()(M()().mark(function X(){var ce,Y,Ve,Fe,Ie=arguments;return M()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(ce=Ie.length>0&&Ie[0]!==void 0?Ie[0]:"",!(!w||!D)){ge.next=4;break}return se([]),ge.abrupt("return");case 4:return E(!0),se([]),Y={type:O,repo_id:w,repo_name:g,branch:D,commit_id:ce},ge.prev=7,ge.next=10,Tr(Y);case 10:Ve=ge.sent,Fe=Ve.data,se(Fe),ge.next=17;break;case 15:ge.prev=15,ge.t0=ge.catch(7);case 17:return ge.prev=17,setTimeout(function(){E(!1)},1e3),ge.finish(17);case 20:case"end":return ge.stop()}},X,null,[[7,15,17,20]])}));return function(){return N.apply(this,arguments)}}(),B=rr()(function(N){return Ye(N)},500),t=(0,c.useMemo)(function(){return(0,e.jsx)(Te.Z,{allowClear:!0,showSearch:!0,disabled:P!==void 0?P:O==="gerrit"?ie===!1:!1,placeholder:K||"\u8BF7\u9009\u62E9 CommitId",optionFilterProp:"children",onChange:x,onSearch:B,notFoundContent:b?(0,e.jsx)(Ge.Z,{size:"small"}):(0,e.jsx)(Re.Z,{}),filterOption:!1,children:de.map(function(N){return(0,e.jsx)(ur,{value:N.commit_id,label:"".concat(N.commit_id.slice(0,8),"\uFF1A").concat(N.title),title:"".concat(N.title,`
`).concat(N.commit_id),children:(0,e.jsxs)("div",{children:[N.commit_id.slice(0,8),"\uFF1A",N.title]})})})})},[w,D,g,O,ie,de,b]);return(0,e.jsx)("div",{ref:Se,className:V+" common-form-commitId-container",style:te,children:(0,e.jsx)(a.Z.Item,{label:n,name:s,initialValue:v,rules:[{required:ae,message:m}],extra:Ze,children:t})})}var mr=(0,c.forwardRef)(yr),je=u(63103),ve=A.Z.TextArea;function ke(i,d){var n=i.item,s=i.configList,v=i.form,O=i.validator,ae=i.nameBlur,m=i.type,w=i.handleRepoDisplay,D=n.prompt_on_trigger,g=n.repoType,V=n.gitUrlName,te=n.gitUrlDefault,ie=n.gitUrlDescription,pe=n.shaName,Ze=n.shaDefault,he=n.shaDescription,x=n.refName,K=n.refDefault,P=n.refDescription,le=(0,c.useState)("config"),T=ue()(le,2),b=T[0],E=T[1],h=(0,c.useState)([]),k=ue()(h,2),G=k[0],$=k[1],Q=(0,c.useState)({}),W=ue()(Q,2),de=W[0],se=W[1],Se=a.Z.useForm(),Pe=ue()(Se,1),C=Pe[0],Le=(0,c.useRef)([]),Ye=(0,c.useRef)(null),B=(0,c.useRef)(null);(0,c.useImperativeHandle)(d,function(){return{componentFormVaild:X,getFormValue:t}}),(0,c.useEffect)(function(){N()},[]);var t=function(o){return C.getFieldValue(o)},N=function(){var o;C.setFieldValue("from",2),n==null||(o=n.repo)===null||o===void 0||o.forEach(function(p){var S=Object.keys(p);S.forEach(function(re){var De=p[re];re==="repo"&&(De=p["repo-name"],w(n.id+"-repoType-repo-display_name",p["repo-display_name"])),re.includes("repo-type")?C.setFieldValue(p.id+"-repoType-"+re,p[re]):setTimeout(function(){C.setFieldValue(p.id+"-repoType-"+re,De)},1e3)})})},X=function(){var R=we()(M()().mark(function o(){var p,S,re,De,He;return M()().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return be.next=2,C.validateFields();case 2:return p=be.sent,S={id:p["".concat(n.id,"-repoType-id")],newId:p["".concat(n.id,"-repoType-id")]+"-repo"},re={id:p["".concat(n.id,"-repoType-id")],newId:p["".concat(n.id,"-repoType-id")]+"-ref"},De={id:p["".concat(n.id,"-repoType-id")],newId:p["".concat(n.id,"-repoType-id")]+"-sha"},He={from:2,index:n.index,id:p["".concat(n.id,"-repoType-id")],type:"repo",prompt_on_trigger:p["".concat(n.id,"-repoType-prompt_on_trigger")],isMoreOptions:p["".concat(n.id,"-repoType-isMoreOptions")],repo:[],isBranch:p["".concat(n.id,"-repoType-ref-isBranch")]},Object.keys(p).forEach(function(Oe){var _e=Oe.replace("".concat(n.id,"-repoType-"),"");_e.includes("ref")?re[_e]=p[Oe]:_e.includes("sha")?De[_e]=p[Oe]:_e!=="id"&&(S[_e]=p[Oe])}),He.repo=[S,re,De],be.abrupt("return",He);case 10:case"end":return be.stop()}},o)}));return function(){return R.apply(this,arguments)}}(),ce=function(o){E(o)},Y=function(o){o.showAll=!o.showAll,$(q()(G))},Ve=function(o,p){C.setFieldValue("".concat(o,"-repoType-repo-name"),void 0),C.setFieldValue("".concat(o,"-repoType-repo-url"),void 0),C.setFieldValue("".concat(o,"-repoType-repo-id"),void 0),C.setFieldValue("".concat(o,"-repoType-repo"),void 0),C.setFieldValue("".concat(o,"-repoType-ref"),void 0),C.setFieldValue("".concat(o,"-repoType-sha"),void 0),C.setFieldValue("".concat(o,"-repoType-ref-patchset"),void 0),Ye.current.setOptionsData([])},Fe=function(o){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};B.current.isRepoChange=!0,C.setFieldValue("".concat(o,"-repoType-repo-name"),p.name),C.setFieldValue("".concat(o,"-repoType-repo-url"),p.url),C.setFieldValue("".concat(o,"-repoType-repo-id"),p.id),C.setFieldValue("".concat(o,"-repoType-ref"),void 0),C.setFieldValue("".concat(o,"-repoType-sha"),void 0),C.setFieldValue("".concat(o,"-repoType-ref-patchset"),void 0)},Ie=function(o){C.setFieldValue("".concat(o,"-repoType-sha"),void 0)},ye=function(){},ge=function(o,p){o.stopPropagation(),G.splice(p,1),$(q()(G))},Xe=function(o,p){p.checked||G.forEach(function(S){S.checked=!1}),p.checked=!p.checked,$(q()(G))},Be=function(o,p,S){C.setFieldValue(p,o),C.setFieldValue("".concat(S,"-repoType-sha"),void 0)},Zr=function(){return(0,e.jsx)("div",{className:"environmentVariable-config"})},fr=function(o){var p=C.getFieldValue(o)||"",S=p.split(`
`).map(function(re){return re.trim()}).filter(Boolean);return q()(new Set(S))},Ir=function(o,p){return p?xe.includes(p)?Promise.reject("\u4E0E\u7CFB\u7EDF\u4FDD\u7559\u5173\u952E\u5B57\u51B2\u7A81"):/^[^\u4e00-\u9fa5\s]*$/.test(p)?Promise.resolve():Promise.reject("\u4E0D\u80FD\u542B\u6709\u4E2D\u6587\u3001\u7A7A\u683C"):Promise.reject("\u8BF7\u8F93\u5165")},ee=function(){var o;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"form-background-container",children:[(0,e.jsxs)("div",{className:"flex-space-between",style:{padding:"0 5px"},children:[(0,e.jsx)("div",{className:"row-left-title",style:{fontWeight:"bold"},children:"\u5206\u652F"}),(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsxs)("div",{className:"row-left-repo flex-end",style:{flex:1},children:[(0,e.jsx)(a.Z.Item,{name:n.id+"-repoType-ref-show",valuePropName:"checked",initialValue:!1,style:{margin:"0"},children:(0,e.jsx)(me.Z,{children:"\u6267\u884C\u65F6\u663E\u793A"})}),(0,e.jsx)(a.Z.Item,{label:"",name:n.id+"-repoType-ref-is_required",initialValue:n.is_required,valuePropName:"checked",style:{margin:0},children:(0,e.jsx)(me.Z,{children:"\u5FC5\u586B"})})]}),(0,e.jsx)("div",{className:"row-right-repo"})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"row-left-repo",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:n.id+"-repoType-ref-name",initialValue:x||"Branch",rules:[{required:!1,message:""},{validator:Ir}],children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:ae})})}),(0,e.jsx)("div",{className:"row-right-repo",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:n.id+"-repoType-ref_display_name",initialValue:n.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{style:{flex:1},children:(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var S=C.getFieldsValue(),re=S[n.id+"-repoType-repo-type"],De=S["".concat(n.id,"-repoType-repo-id")],He="".concat(n.id,"-repoType-ref-isBranch"),Je="".concat(n.id,"-repoType-ref-patchset"),be="".concat(n.id,"-repoType-ref-tag"),Oe=C.getFieldValue("".concat(n.id,"-repoType-ref-isBranch")),_e=Oe,Lr="\u9ED8\u8BA4\u503C",Or=C.getFieldValue("".concat(n.id,"-repoType-repo-name"));return(0,e.jsx)("div",{style:{paddingBottom:"10px"},children:(0,e.jsx)(je.Z,{name:"".concat(n.id,"-repoType-ref"),label:Lr,initialValue:void 0,repoType:re,repoId:De,change:function(dn){return Ie(n.id)},isBranch:He,onSwitchBranchChange:Be,isBranchValue:_e,id:n.id,repoName:Or,required:!1,patchsetName:Je,form:C,tagName:be,detailVal:de})})}})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"all-repo flex-start",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:n.id+"-repoType-ref-description",initialValue:P,style:{width:"100%"},className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:P||(n==null||(o=n.repo)===null||o===void 0||(o=o.find(function(p){return p==null?void 0:p["ref-description"]}))===null||o===void 0?void 0:o["ref-description"])||"",hideTitle:!0,isSimple:!0,disabled:m!==1})})})]})]}),(0,e.jsx)(a.Z.Item,{shouldUpdate:!0,children:function(){var S,re=C.getFieldValue("".concat(n.id,"-repoType-ref")),De=C.getFieldValue("".concat(n.id,"-repoType-ref-isBranch"));return!re||De!=="branch"?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("div",{className:"form-background-container",children:[(0,e.jsxs)("div",{className:"flex-space-between",style:{padding:"0 0px"},children:[(0,e.jsx)("div",{className:"row-left-title",style:{fontWeight:"bold"},children:"CommitId"}),(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsxs)("div",{className:"row-left-repo flex-end",style:{flex:1},children:[(0,e.jsx)(a.Z.Item,{name:n.id+"-repoType-sha-show",valuePropName:"checked",initialValue:!1,style:{marginLeft:"20px",margin:"0"},children:(0,e.jsx)(me.Z,{children:"\u6267\u884C\u65F6\u663E\u793A"})}),(0,e.jsx)(a.Z.Item,{label:"",name:n.id+"-repoType-sha-is_required",initialValue:n.is_required,valuePropName:"checked",style:{margin:0},children:(0,e.jsx)(me.Z,{children:"\u5FC5\u586B"})})]}),(0,e.jsx)("div",{className:"row-right-repo"})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-title"}),(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"row-left-repo",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:n.id+"-repoType-sha-name",initialValue:pe||"CommitId",rules:[{required:!1,message:""},{validator:Ir}],children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:ae})})}),(0,e.jsx)("div",{className:"row-right-repo",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:n.id+"-repoType-sha_display_name",initialValue:n.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{style:{flex:1},children:(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var Je=C.getFieldsValue(),be=Je[n.id+"-repoType-repo-type"],Oe=Je["".concat(n.id,"-repoType-repo-id")],_e=Je["".concat(n.id,"-repoType-ref-isBranch")]||be!=="gerrit",Lr=Je["".concat(n.id,"-repoType-ref")]||C.getFieldValue("".concat(n.id,"-repoType-ref")),Or=Je["".concat(n.id,"-repoType-repo-name")];return(0,e.jsx)(mr,{ref:Le,name:"".concat(n.id,"-repoType-sha"),label:"\u9ED8\u8BA4\u503C",initialValue:void 0,repoType:be,repoId:Oe,branch:Lr,repoName:Or,change:ye,required:!1,message:"\u8BF7\u8F93\u5165",isBranchValue:_e,disabled:m!==1})}})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"all-repo flex-start",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:n.id+"-repoType-sha-description",initialValue:he,style:{width:"100%"},className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:he||(n==null||(S=n.repo)===null||S===void 0||(S=S.find(function(He){return He==null?void 0:He["sha-description"]}))===null||S===void 0?void 0:S["sha-description"])||"",hideTitle:!0,isSimple:!0,disabled:m!==1})})})]})]})}})]})},Z=function(o,p){return p?/^[^\u4e00-\u9fa5\s]*$/.test(p)?Promise.resolve():Promise.reject("\u4E0D\u80FD\u542B\u6709\u4E2D\u6587\u3001\u7A7A\u683C"):Promise.reject("\u8BF7\u8F93\u5165")},J=function(){var o;return C.setFieldValue(n.id+"-repoType-id",n.id),(0,e.jsxs)("div",{children:[(0,e.jsx)(a.Z.Item,{noStyle:!0,name:"from"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:n.id+"-repoType-repo-name"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:n.id+"-repoType-repo-url"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:n.id+"-repoType-id"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:n.id+"-repoType-repo-id"}),(0,e.jsx)("div",{className:"form-background-container",children:(0,e.jsxs)("div",{className:"item-row flex-space-between ",children:[(0,e.jsx)("div",{className:"row-left-title",children:"Repo"}),(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"row-left-repo",children:(0,e.jsx)(a.Z.Item,{label:"\u4ED3\u5E93\u7C7B\u578B",name:n.id+"-repoType-repo-type",initialValue:"gerrit",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED3\u5E93\u7C7B\u578B"}],style:{width:"100%"},children:(0,e.jsx)(Te.Z,{options:[{label:"Gerrit",value:"gerrit"},{label:"Gitlab-EE",value:"gitlabee"},{label:"Gitlab-CE",value:"gitlabce"}],onChange:function(S){return Ve(n.id,S)}})})}),(0,e.jsxs)("div",{className:"row-right-repo flex-start",children:[(0,e.jsx)(a.Z.Item,{label:"\u4ED3\u5E93\u663E\u793A\u540D\u79F0",name:n.id+"-repoType-repo-display_name",initialValue:"gerrit",style:{marginRight:"20px",width:"60%"},children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:function(S){var re=S.target.value;w(n.id+"-repoType-repo-display_name",re)}})}),(0,e.jsx)(a.Z.Item,{label:"",noStyle:!0,name:n.id+"-repoType-isMoreOptions",initialValue:n.isMoreOptions,valuePropName:"checked",children:(0,e.jsx)(me.Z,{children:"\u9AD8\u7EA7\u9009\u9879"})})]})]})}),(0,e.jsxs)("div",{className:"form-background-container",children:[(0,e.jsxs)("div",{className:"flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-title",style:{fontWeight:"bold"},children:"\u4ED3\u5E93\u540D\u79F0"}),(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsxs)("div",{className:"row-left-repo flex-end",style:{flex:1},children:[(0,e.jsx)(cr.Z,{title:"\u6682\u4E0D\u652F\u6301\u8BE5\u64CD\u4F5C",children:(0,e.jsx)(a.Z.Item,{label:"",name:n.id+"-repoType-prompt_on_trigger",initialValue:!0,valuePropName:"checked",style:{margin:0},children:(0,e.jsx)(me.Z,{disabled:!0,children:"\u6267\u884C\u65F6\u663E\u793A"})})}),"\xA0\xA0\xA0",(0,e.jsx)(a.Z.Item,{label:"",name:n.id+"-repoType-is_required",initialValue:n.is_required,valuePropName:"checked",style:{margin:0},children:(0,e.jsx)(me.Z,{children:"\u5FC5\u586B"})})]}),(0,e.jsx)("div",{className:"row-right-repo"})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-title"}),(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"row-left-repo",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:n.id+"-repoType-git_url-name",initialValue:g||"RepoName",rules:[{required:!0,message:""},{validator:Ir}],children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:ae})})}),(0,e.jsx)("div",{className:"row-right-repo",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:n.id+"-repoType-repo_display_name",initialValue:n.display_name||"\u4ED3\u5E93\u540D\u79F0",children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{style:{flex:1},children:(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return(0,e.jsx)(lr.Z,{ref:Ye,name:"".concat(n.id,"-repoType-repo"),label:"\u9ED8\u8BA4\u503C",initialValue:void 0,repoType:C.getFieldValue(n.id+"-repoType-repo-type"),repoChange:function(re){return Fe(n.id,re)},required:!1,message:""})}})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left-name"}),(0,e.jsx)("div",{className:"all-repo",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:n.id+"-repoType-git_url-description",initialValue:ie,className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:ie||(n==null||(o=n.repo)===null||o===void 0||(o=o.find(function(p){return p==null?void 0:p["git_url-description"]}))===null||o===void 0?void 0:o["git_url-description"])||"",hideTitle:!0,isSimple:!0,disabled:m!==1})})})]})]}),(0,e.jsx)(a.Z.Item,{shouldUpdate:!0,children:function(){var S=C.getFieldValue("".concat(n.id,"-repoType-repo"));return S?ee():(0,e.jsx)(e.Fragment,{})}})]})};return(0,e.jsx)("div",{className:"flex-baseConfig-environmentVariable-container flow-config-environmentVariable-repo-container",ref:B,children:(0,e.jsx)(a.Z,{layout:"vertical",form:C,children:J()})})}var fe=(0,c.forwardRef)(ke),br=u(86738),un=u(48689),Ue=u(64789),Cr=u(81470),Jn=A.Z.TextArea;function vn(i,d){var n=i.item,s=i.configList,v=i.form,O=i.data,ae=i.parentType,m=(0,c.useState)("config"),w=ue()(m,2),D=w[0],g=w[1],V=(0,c.useState)([]),te=ue()(V,2),ie=te[0],pe=te[1],Ze=a.Z.useForm(),he=ue()(Ze,1),x=he[0],K=(0,c.useRef)([]),P=(0,c.useRef)([]),le=(0,c.useRef)(null);(0,c.useImperativeHandle)(d,function(){return{componentFormVaild:b}}),(0,c.useEffect)(function(){T()},[]),(0,c.useEffect)(function(){setTimeout(function(){x.validateFields()},5e3)},[]);var T=function(){var t;x.setFieldValue("from",2);var N=(0,Ae.DP)().pipelineId,X=[],ce=(t=O.setting)===null||t===void 0||(t=t.extra_data)===null||t===void 0?void 0:t.envComponentList;ce&&(X=ce[Object.keys(ce)[0]]||[]),pe(X),X.forEach(function(Y){var Ve=Object.keys(Y);Ve.forEach(function(Fe){var Ie=Y[Fe];Fe.includes("-options")&&Ie&&(Ie=Ie.join(`
`)),Fe==="repo"&&(Ie=Y["repo-name"]),Fe.includes("repo-type")?x.setFieldValue(Y.id+"-component-"+Fe,Y[Fe]):setTimeout(function(){x.setFieldValue(Y.id+"-component-"+Fe,Ie)},1e3)})})},b=function(){var B=we()(M()().mark(function t(){var N,X;return M()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,x.validateFields();case 2:return N=Y.sent,X=[],ie.forEach(function(Ve){var Fe=Ve.id+"-component-",Ie={checked:Ve.checked};for(var ye in N)if(N.hasOwnProperty(ye)&&ye.includes(Fe)){var ge=ye.replace(Fe,""),Xe=N[ye];if(ge.includes("-options")&&Xe){var Be=Xe.split(`
`).map(function(Zr){return Zr.trim()}).filter(Boolean);Xe=q()(new Set(Be))}Ie[ge]=Xe}X.push(Ie)}),Y.abrupt("return",X);case 6:case"end":return Y.stop()}},t)}));return function(){return B.apply(this,arguments)}}(),E=function(t){g(t)},h=function(t){t.showAll=!t.showAll,pe(q()(ie))},k=function(t,N,X){x.setFieldValue("".concat(t,"-component-repo-name"),void 0),x.setFieldValue("".concat(t,"-component-repo-url"),void 0),x.setFieldValue("".concat(t,"-component-http_url"),void 0),x.setFieldValue("".concat(t,"-component-repo-id"),void 0),x.setFieldValue("".concat(t,"-component-repo"),void 0),x.setFieldValue("".concat(t,"-component-ref"),void 0),x.setFieldValue("".concat(t,"-component-sha"),void 0),x.setFieldValue("".concat(t,"-component-patchset"),void 0),x.setFieldValue("".concat(t,"-component-isBranch"),!0),P.current[X].setOptionsData([])},G=function(t){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};le.current.isRepoChange=!0,x.setFieldValue("".concat(t,"-component-repo-name"),N.name),x.setFieldValue("".concat(t,"-component-repo-url"),N.url),x.setFieldValue("".concat(t,"-component-http_url"),N.http_url),x.setFieldValue("".concat(t,"-component-repo-id"),N.id),x.setFieldValue("".concat(t,"-component-ref"),void 0),x.setFieldValue("".concat(t,"-component-sha"),void 0),x.setFieldValue("".concat(t,"-component-patchset"),void 0)},$=function(t,N){x.setFieldValue("".concat(t,"-component-sha"),void 0)},Q=function(){},W=function(t,N){t.stopPropagation(),ie.splice(N,1),pe(q()(ie))},de=function(){ae===1&&(ie.push({id:Math.random(),showAll:!0,name:"component".concat(ie.length+1),default:"",description:"",type:"component",prompt_on_trigger:!0,checked:!1,isBranch:!1}),pe(q()(ie)))},se=function(t,N){N.checked||ie.forEach(function(X){X.checked=!1}),N.checked=!N.checked,pe(q()(ie))},Se=function(t,N,X){x.setFieldValue(N,t),x.setFieldValue("".concat(X,"-component-sha"),void 0)},Pe=function(){return(0,e.jsx)("div",{className:"environmentVariable-config"})},C=function(t){var N=x.getFieldValue(t)||"",X=N.split(`
`).map(function(ce){return ce.trim()}).filter(Boolean);return q()(new Set(X))},Le=function(t,N){x.setFieldValue(t.id+"-component-id",t.id);var X="";return(0,e.jsxs)("div",{children:[(0,e.jsx)(a.Z.Item,{noStyle:!0,name:"from"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:t.id+"-component-repo-name"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:t.id+"-component-repo-url"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:t.id+"-component-http_url"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:t.id+"-component-id"}),(0,e.jsx)(a.Z.Item,{noStyle:!0,name:t.id+"-component-repo-id"}),(0,e.jsxs)("div",{className:"flex-space-between",children:[(0,e.jsx)(a.Z.Item,{label:"\u7EC4\u4EF6\u540D",name:t.id+"-component-component",initialValue:t.name,rules:[{required:!0,message:"\u8BF7\u586B\u5199\u540D\u79F0"}],style:{width:"48%"},children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})}),(0,e.jsx)(a.Z.Item,{label:"\u4ED3\u5E93\u7C7B\u578B",name:t.id+"-component-repo-type",initialValue:"gerrit",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED3\u5E93\u7C7B\u578B"}],style:{width:"48%"},children:(0,e.jsx)(Te.Z,{options:[{label:"Gerrit",value:"gerrit"},{label:"Gitlab-EE",value:"gitlabee"},{label:"Gitlab-CE",value:"gitlabce"}],onChange:function(Y){return k(t.id,Y,N)}})})]}),(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return(0,e.jsx)(lr.Z,{ref:function(Ve){return P.current[N]=Ve},name:"".concat(t.id,"-component-repo"),label:"\u4ED3\u5E93",initialValue:void 0,repoType:x.getFieldValue(t.id+"-component-repo-type"),repoChange:function(Ve){return G(t.id,Ve)},required:!0,message:"\u8BF7\u8F93\u5165"})}}),(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var Y=x.getFieldsValue(),Ve=Y[t.id+"-component-repo-type"],Fe=Y["".concat(t.id,"-component-repo-id")],Ie="".concat(t.id,"-component-isBranch"),ye="".concat(t.id,"-component-patchset"),ge=Y["".concat(t.id,"-component-isBranch")]===void 0?t.isBranch:Y["".concat(t.id,"-component-isBranch")],Xe="\u4EE3\u7801\u5206\u652F",Be=x.getFieldValue("".concat(t.id,"-component-repo-name"));return(0,e.jsx)(Cr.Z,{name:"".concat(t.id,"-component-ref"),label:Xe,initialValue:void 0,repoType:Ve,repoId:Fe,change:function(fr){return $(t.id,N)},required:!1,message:"\u8BF7\u8F93\u5165",isBranch:Ie,onSwitchBranchChange:Se,repoName:Be,patchsetName:ye,isBranchValue:ge,id:t.id,from:x})}}),(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var Y=x.getFieldsValue(),Ve=Y[t.id+"-component-repo-type"],Fe=Y["".concat(t.id,"-component-repo-id")],Ie=Y["".concat(t.id,"-component-isBranch")]===void 0?t.isBranch:Y["".concat(t.id,"-component-isBranch")],ye=Y["".concat(t.id,"-component-ref")]||x.getFieldValue("".concat(t.id,"-component-ref")),ge=Y["".concat(t.id,"-component-repo-name")];return(0,e.jsx)(mr,{ref:function(Be){return K.current[N]=Be},name:"".concat(t.id,"-component-sha"),label:"CommitId",initialValue:void 0,repoType:Ve,repoId:Fe,branch:ye,repoName:ge,change:Q,required:!1,message:"\u8BF7\u8F93\u5165",isBranchValue:Ie})}})]})},Ye=function(){return(0,e.jsx)("div",{className:"environmentVariable-list",children:(0,e.jsxs)(a.Z,{layout:"vertical",form:x,children:[ie.map(function(t,N){return(0,e.jsxs)("div",{className:"environmentVariable-list-item",children:[(0,e.jsxs)("nav",{children:[(0,e.jsxs)("div",{onClick:function(){return h(t)},children:[(0,e.jsx)(ze.Z,{className:"arrow ".concat(t.showAll&&"arrow-rotate")}),"\xA0\xA0",(0,e.jsx)("div",{style:{display:"inline-block"},onClick:function(ce){return ce.stopPropagation()},children:(0,e.jsx)(me.Z,{onChange:function(ce){return se(ce,t)},checked:t.checked,children:(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var ce=x.getFieldValue(t.id+"-component-component")||t.name;return ce}})})})]}),(0,e.jsx)(br.Z,{placement:"topLeft",title:"\u786E\u8BA4\u5220\u9664",onConfirm:function(ce){return W(ce,N)},okText:"Yes",cancelText:"No",children:(0,e.jsxs)("div",{className:"remove-component",onClick:function(ce){return ce.stopPropagation()},children:[(0,e.jsx)(un.Z,{})," \u5220\u9664\u7EC4\u4EF6"]})})]}),(0,e.jsx)("div",{className:"item-content",style:{display:t.showAll?"block":"none"},children:Le(t,N)})]})}),(0,e.jsx)("div",{className:"flex-center add-component",children:(0,e.jsxs)("div",{className:"add-component-button ".concat(ae!==1&&"component-disabled"),onClick:de,children:[(0,e.jsx)(Ue.Z,{})," \xA0\u65B0\u589E\u7EC4\u4EF6"]})})]})})};return(0,e.jsx)("div",{className:"flex-baseConfig-environmentVariable-container",ref:le,children:Ye()})}var hn=(0,c.forwardRef)(vn),gn=A.Z.TextArea;function xn(i){var d=i.item,n=i.validator,s=i.nameBlur;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:d.id+"-name",rules:[{required:"true",message:""},{validator:n}],initialValue:d.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:s})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:d.id+"-display_name",initialValue:d.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsx)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:(0,e.jsx)("div",{style:{flex:1},children:(0,e.jsx)(a.Z.Item,{label:"\u9ED8\u8BA4\u503C",name:d.id+"-default",initialValue:d.default,children:(0,e.jsx)(gn,{placeholder:"\u8BF7\u8F93\u5165",autoSize:{minRows:1}})})})})]})}var jn=xn;function Fn(i){var d=i.item,n=i.validator,s=i.nameBlur;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:d.id+"-name",rules:[{required:"true",message:""},{validator:n}],initialValue:d.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:s})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:d.id+"-display_name",initialValue:d.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsx)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:(0,e.jsx)("div",{style:{flex:1},children:(0,e.jsx)(a.Z.Item,{label:"\u9ED8\u8BA4\u503C",name:d.id+"-default",initialValue:d.default===void 0?!0:d.default,rules:[{required:"true",message:"\u8BF7\u9009\u62E9"}],children:(0,e.jsxs)(Ne.ZP.Group,{children:[(0,e.jsx)(Ne.ZP,{value:!0,children:"true"}),(0,e.jsx)(Ne.ZP,{value:!1,children:"false"})]})})})})]})}var yn=Fn,sn=u(75440),_n=sn.default.RangePicker;function bn(i){var d=i.item,n=i.validator,s=i.nameBlur,v=function(m,w){if(!w)return Promise.resolve();var D=Ce()(),g=Ce()(w);return D.isAfter(g)?Promise.reject("\u9700\u5927\u4E8E\u5F53\u524D\u65F6\u95F4"):Promise.resolve()};function O(ae){return ae&&ae<Ce()().startOf("day")}return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:d.id+"-name",rules:[{required:!0,message:""},{validator:n}],initialValue:d.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:s})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:d.id+"-display_name",initialValue:d.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsx)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:(0,e.jsx)("div",{style:{flex:1},children:(0,e.jsx)(a.Z.Item,{label:"\u9ED8\u8BA4\u503C",name:d.id+"-default",initialValue:d.default?Ce()(d.default):"",rules:[{required:!1,message:""},{validator:v}],children:(0,e.jsx)(sn.default,{style:{width:"100%"},showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",disabledDate:O})})})})]})}var Cn=bn,Zn=A.Z.TextArea;function In(i,d){var n=i.item,s=i.validator,v=i.nameBlur,O=i.form;(0,c.useImperativeHandle)(d,function(){return{handleChooseSubmitData:ae}});var ae=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]},m=function(){var D="".concat(n.id,"-choose-options"),g=O.getFieldValue(D)||"",V=g.split(`
`).map(function(te){return te.trim()}).filter(Boolean);return q()(new Set(V))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:n.id+"-name",rules:[{required:"true",message:""},{validator:s}],initialValue:n.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:v})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:n.id+"-display_name",initialValue:n.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"\u4E0B\u62C9\u9009\u9879",name:"".concat(n.id,"-choose-options"),tooltip:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:"1. \u591A\u4E2A\u9009\u9879\u7528\u6362\u884C\u7B26\u5206\u9694"}),(0,e.jsx)("div",{children:"2. \u91CD\u590D\u7684\u9009\u9879\u5C06\u53EA\u4F1A\u663E\u793A\u4E00\u4E2A"})]}),style:{width:"100%"},rules:[{required:!0,message:"\u8BF7\u586B\u5199"}],initialValue:n["choose-options"],children:(0,e.jsx)(Zn,{placeholder:`option1
option2`,autoSize:{minRows:1,maxRows:4},onChange:function(){return O.setFieldValue("".concat(n.id,"-default"),void 0)}})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return(0,e.jsx)(a.Z.Item,{label:"\u9ED8\u8BA4\u503C",name:n.id+"-default",initialValue:n.default,children:(0,e.jsx)(Te.Z,{allowClear:!0,showSearch:!0,placeholder:"\u67E5\u627E\u9009\u9879",optionFilterProp:"children",filterOption:function(g,V){var te;return((te=V==null?void 0:V.label)!==null&&te!==void 0?te:"").toLowerCase().includes(g.toLowerCase())},children:m().map(function(D){return(0,e.jsx)(Option,{value:D,label:D,title:"".concat(D),children:(0,e.jsx)("div",{children:D})})})})})}})})]})]})}var wn=(0,c.forwardRef)(In),Vn=A.Z.TextArea;function En(i,d){var n=i.item,s=i.validator,v=i.nameBlur,O=i.form;(0,c.useImperativeHandle)(d,function(){return{handleChooseSubmitData:ae}});var ae=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]},m=function(){var D="".concat(n.id,"-choose-options"),g=O.getFieldValue(D)||"",V=g.split(`
`).map(function(te){return te.trim()}).filter(Boolean);return q()(new Set(V))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:n.id+"-name",rules:[{required:"true",message:""},{validator:s}],initialValue:n.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:v})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:n.id+"-display_name",initialValue:n.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsxs)("div",{className:"item-row flex-space-between",style:{alignItems:"flex-start"},children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"\u4E0B\u62C9\u9009\u9879",name:"".concat(n.id,"-choose-options"),tooltip:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:"1. \u591A\u4E2A\u9009\u9879\u7528\u6362\u884C\u7B26\u5206\u9694"}),(0,e.jsx)("div",{children:"2. \u91CD\u590D\u7684\u9009\u9879\u5C06\u53EA\u4F1A\u663E\u793A\u4E00\u4E2A"})]}),style:{width:"100%"},rules:[{required:!0,message:"\u8BF7\u586B\u5199"}],initialValue:n["choose-options"],children:(0,e.jsx)(Vn,{placeholder:`option1
option2`,autoSize:{minRows:1,maxRows:4},onChange:function(){return O.setFieldValue("".concat(n.id,"-default"),void 0)}})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return(0,e.jsx)(a.Z.Item,{label:"\u9ED8\u8BA4\u503C",name:n.id+"-default",initialValue:n.default||[],children:(0,e.jsx)(Te.Z,{allowClear:!0,showSearch:!0,mode:"multiple",placeholder:"\u67E5\u627E\u9009\u9879",optionFilterProp:"children",filterOption:function(g,V){var te;return((te=V==null?void 0:V.label)!==null&&te!==void 0?te:"").toLowerCase().includes(g.toLowerCase())},children:m().map(function(D){return(0,e.jsx)(Option,{value:D,label:D,title:"".concat(D),children:(0,e.jsx)("div",{children:D})})})})})}})})]})]})}var Nn=(0,c.forwardRef)(En),Sn=u(70646);function Tn(i){var d=i.item,n=i.form,s=i.type,v=i.validator,O=i.nameBlur,ae=function(w){n.setFieldValue(d.id+"-default",w),n.validateFields([d.id+"-default"])};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:d.id+"-name",rules:[{required:!0,message:""},{validator:v}],initialValue:d.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:O})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:d.id+"-display_name",initialValue:d.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsx)(a.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){var w=n.getFieldValue(d.id+"-default");return(0,e.jsx)(a.Z.Item,{name:d.id+"-default",label:"\u4E0A\u4F20",style:{padding:"0px 20px"},initialValue:d.default||w,children:(0,e.jsx)(Sn.Z,{getImageUrl:ae,img:d.default||w,disabled:s!==1})})}})]})}var Bn=Tn,An=u(24031),qn=A.Z.TextArea;function Dn(i){var d=i.item,n=i.form,s=i.type,v=i.validator,O=i.nameBlur;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:d.id+"-name",rules:[{required:!0,message:""},{validator:v}],initialValue:d.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:O})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:d.id+"-display_name",initialValue:d.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsx)(a.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){var m=n.getFieldValue(d.id+"-default"),w=d.default||m;return(0,e.jsx)(a.Z.Item,{name:d.id+"-default",label:"\u4E0A\u4F20",style:{padding:"0px 20px"},initialValue:w,children:(0,e.jsx)(An.Z,_()(_()({},i),{},{name:d.id+"-default",value:m}))})}})]})}var Rn=Dn;function kn(i){return rn.apply(this,arguments)}function rn(){return rn=we()(M()().mark(function i(d){var n;return M()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,(0,Fr.ZP)("/api/devices/info/find_user",{method:"get",params:{username:d||""}});case 3:return n=v.sent,n=n.map(function(O){return O.label=O.username,O.value=O.user_id,O}),v.abrupt("return",n);case 8:v.prev=8,v.t0=v.catch(0),console.log(v.t0);case 11:case"end":return v.stop()}},i,null,[[0,8]])})),rn.apply(this,arguments)}var ea=A.Z.TextArea;function Pn(i){var d=i.item,n=i.form,s=i.type,v=i.validator,O=i.nameBlur,ae=(0,c.useState)([]),m=ue()(ae,2),w=m[0],D=m[1],g=(0,c.useState)(!1),V=ue()(g,2),te=V[0],ie=V[1],pe=function(){var K=we()(M()().mark(function P(){var le,T,b=arguments;return M()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return le=b.length>0&&b[0]!==void 0?b[0]:"",h.prev=1,Ze(!0),h.next=5,kn(le);case 5:T=h.sent,D(T),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(1),console.log(h.t0);case 12:return h.prev=12,Ze(!1),h.finish(12);case 15:case"end":return h.stop()}},P,null,[[1,9,12,15]])}));return function(){return K.apply(this,arguments)}}(),Ze=function(P){P&&D([]),ie(P)},he=function(P){pe(P)},x=rr()(he,500);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"Key",name:d.id+"-name",rules:[{required:!0,message:""},{validator:v}],initialValue:d.name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165",onChange:O})})}),(0,e.jsx)("div",{className:"row-right",children:(0,e.jsx)(a.Z.Item,{label:"\u663E\u793A\u540D\u79F0",name:d.id+"-display_name",initialValue:d.display_name,children:(0,e.jsx)(A.Z,{placeholder:"\u8BF7\u8F93\u5165"})})})]}),(0,e.jsx)(a.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){var P=n.getFieldValue(d.id+"-default"),le=d.default||P;return(0,e.jsx)(a.Z.Item,{name:d.id+"-default",label:"\u7528\u6237",style:{padding:"0px 20px"},initialValue:le,children:(0,e.jsx)(Te.Z,{allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:!1,mode:"multiple",placeholder:"\u8BF7\u9009\u62E9",notFoundContent:te?(0,e.jsx)(Ge.Z,{size:"small"}):(0,e.jsx)(Re.Z,{image:Re.Z.PRESENTED_IMAGE_SIMPLE}),onSearch:function(b){return x(b)},children:w==null?void 0:w.map(function(T){return(0,e.jsx)(Option,{value:"".concat(T.label," ").concat(T.value),label:T.label,children:(0,e.jsxs)("div",{className:"demo-option-label-item",children:[(0,e.jsx)("span",{role:"img","aria-label":"China",children:T.label}),T.user_id&&(0,e.jsxs)("span",{children:["\xA0",T.user_id]})]})})})})})}})]})}var Ln=Pn,On=u(59259),$n=u(60219),Ur=u(14754),ra=A.Z.TextArea;function Un(i,d){var n=i.data,s=i.type,v=(0,c.useState)(!1),O=ue()(v,2),ae=O[0],m=O[1],w=(0,c.useState)([]),D=ue()(w,2),g=D[0],V=D[1],te=(0,c.useState)(!1),ie=ue()(te,2),pe=ie[0],Ze=ie[1],he=(0,c.useState)([]),x=ue()(he,2),K=x[0],P=x[1],le=(0,c.useState)([]),T=ue()(le,2),b=T[0],E=T[1],h=(0,c.useRef)([]),k=(0,Ur.v9)(function(ee){var Z=ee.pipeline;return Z}),G=(0,Ur.I0)(),$=(0,c.useRef)(null),Q=a.Z.useForm(),W=ue()(Q,1),de=W[0],se=(0,Ae.DP)(),Se=se.pipelineId,Pe=se.from,C=k.list.findIndex(function(ee){return ee.id===Se});(0,c.useImperativeHandle)(d,function(){return{open:Le,saveRelationData:X}});var Le=function(Z){Ye(Z),m(!0)},Ye=function(){var Z,J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];h.current=[],J=J.filter(function(S){return S.type!=="component"&&S.type!=="repo"}),J.forEach(function(S){if(S.type==="repo"){var re=S.repo;h.current.push({id:re[0].newId,name:re[0]["git_url-name"]}),h.current.push({id:re[1].newId,name:re[1]["ref-name"]}),h.current.push({id:re[2].newId,name:re[2]["sha-name"]})}else h.current.push(S)});var R=k.list[C],o=(Z=R.setting)===null||Z===void 0||(Z=Z.extra_data)===null||Z===void 0?void 0:Z.relationList;if(o){var p=B(o);E(p)}V(J)},B=function(Z){var J=[];return Z.forEach(function(R){var o=R.options,p=R.value;if(o=o.map(function(re){var De;return(De=h.current.find(function(He){return He.id===re}))===null||De===void 0?void 0:De.id}).filter(Boolean),o.length>=2){var S=o.find(function(re){return re===p});p=S||o[0],J.push({value:p,options:o})}}),J},t=function(){X(),Ze(!1),m(!1)},N=function(){var ee=we()(M()().mark(function Z(){return M()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(Fe()){R.next=2;break}return R.abrupt("return");case 2:X(),m(!1);case 4:case"end":return R.stop()}},Z)}));return function(){return ee.apply(this,arguments)}}(),X=function(){var Z=k.list[C];Z.setting.extra_data=Z.setting.extra_data||{},Z.setting.extra_data.relationList=b,k.list[C]=_()({},Z),G({type:"pipeline/setList",payload:{list:q()(k.list)}})},ce=function(Z){P(Z)},Y=function(Z,J,R){return pe?(0,e.jsx)(me.Z,{value:J,disabled:R,children:Z}):Z},Ve=function(){Ze(!0)},Fe=function(){if(K.length===1){Vr.ZP.warn("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E24\u4E2A");return}return K.length>0&&(b.push({value:K[0],options:K}),E(b)),P([]),Ze(!1),!0},Ie=function(Z){var J=g.filter(function(be){return be.type==="repo"}),R="\u4ED3\u5E93"+(J.length+1-(J.findIndex(function(be){return be.id===Z.id})+1)),o=Z.repo,p=o[0]["git_url-name"]||"-",S=o[1]["ref-name"],re=o[2]["sha-name"],De=b.find(function(be){return be.options.find(function(Oe){return Oe===o[0].newId})}),He=b.find(function(be){return be.options.find(function(Oe){return Oe===o[1].newId})}),Je=b.find(function(be){return be.options.find(function(Oe){return Oe===o[2].newId})});return(0,e.jsxs)("div",{children:[R,(0,e.jsxs)("div",{children:[Y((0,e.jsxs)("div",{children:["\u4ED3\u5E93\uFF1A",p]}),o[0].newId,!0),S&&Y((0,e.jsxs)("div",{children:["\u5206\u652F/patchset\uFF1A",S||"-"]}),o[1].newId,!0),re&&Y((0,e.jsxs)("div",{children:["commitId\uFF1A",re||"-"]}),o[2].newId,Je)]})]})},ye=function(Z){var J=Z.default;switch(Z.type){case"multiple":var R=J||[];J=R.join("\u3001");break;case"bool":J=String(J);break;case"date":J&&(J=Ce()(J).format("YYYY-MM-DD HH:mm:ss"));break}var o=b.find(function(p){return p.options.find(function(S){return S===Z.id})});return(0,e.jsx)("div",{children:(0,e.jsx)("div",{className:"flex-start",children:pe?(0,e.jsx)(me.Z,{value:Z.id,disabled:o,children:(0,e.jsxs)("div",{className:"flex-start",children:[Z.name,"\uFF1A",(0,e.jsx)("div",{className:"item-default",children:J||"-"})]})}):(0,e.jsxs)(e.Fragment,{children:[Z.name,"\uFF1A",(0,e.jsx)("div",{className:"item-default",children:J||"-"})]})})})},ge=function(Z){switch(Z.type){case"repo":return Ie(Z);default:return ye(Z)}},Xe=function(){return g.length<=0?(0,e.jsx)(e.Fragment,{children:"\u6682\u65E0\u53EF\u8BBE\u7F6E\u7684\u53D8\u91CF"}):(0,e.jsx)(e.Fragment,{children:g.map(function(Z){var J=b.find(function(R){return R.options.find(function(o){return o===Z.id})});return(0,e.jsx)("div",{className:"relation-item",style:{borderColor:!J&&pe?"#8fc9ff":"#eee"},children:ge(Z)})})})},Be=function(Z,J){J.value=Z.target.value,E(q()(b))},Zr=function(Z){var J,R=(J=h.current.find(function(o){return o.id===Z}))===null||J===void 0?void 0:J.name;return(0,e.jsx)(e.Fragment,{children:R})},fr=function(Z){b.splice(Z,1),E(q()(b))},Ir=function(Z,J){return(0,e.jsxs)("div",{className:"item-relation-radio",children:[(0,e.jsx)(Ne.ZP.Group,{onChange:function(o){return Be(o,Z)},value:Z.value,disabled:s!==1,children:Z.options.map(function(R){return(0,e.jsx)(Ne.ZP,{value:R,children:Zr(R)})})}),s===1&&(0,e.jsx)("div",{className:"radio-reduce flex-center",onClick:function(){return fr(J)},children:(0,e.jsx)(Sr.Z,{})})]})};return(0,e.jsx)("div",{ref:$,children:(0,e.jsxs)(On.Z,{title:"",centered:!0,destroyOnClose:!0,footer:[(0,e.jsx)(nr.ZP,{onClick:t,children:"\u53D6\u6D88"}),(0,e.jsx)(nr.ZP,{type:"primary",onClick:N,children:"\u786E\u5B9A"})],open:ae,onCancel:t,className:"flow-environmentVariable-relation-container",width:"50%",children:[(0,e.jsx)("div",{className:"relation-title",children:"\u73AF\u5883\u53D8\u91CF"}),(0,e.jsx)("div",{className:"top-scroll common-scroll-bar",children:(0,e.jsx)(me.Z.Group,{style:{width:"100%"},onChange:ce,value:K,children:Xe()})}),(0,e.jsxs)("div",{className:"flex-start",style:{marginTop:"5px"},children:[(0,e.jsx)("div",{className:"relation-title",children:"\u4E92\u65A5\u5173\u7CFB"}),(0,e.jsx)("div",{style:{color:"#7b7d8a"},children:"\uFF08\u6BCF\u7EC4\u4E92\u65A5\u53C2\u6570\u503C\u53EA\u80FD\u591A\u9009\u4E00\uFF0C\u9009\u4E2D\u4E3A\u9ED8\u8BA4\u503C\uFF09"})]}),(0,e.jsxs)("div",{className:"bottom-content",children:[b.length>0?(0,e.jsx)(e.Fragment,{children:b.map(function(ee,Z){return Ir(ee,Z)})}):"",(0,e.jsx)("div",{style:{margin:"5px 0"},children:pe?(0,e.jsx)(nr.ZP,{icon:(0,e.jsx)($n.Z,{}),type:"primary",style:{width:"100%"},onClick:Fe,children:"\u4FDD\u5B58"}):(0,e.jsx)(nr.ZP,{icon:(0,e.jsx)(ir.Z,{}),onClick:Ve,style:{width:"100%"},disabled:s!==1,children:"\u6DFB\u52A0\u4E92\u65A5"})})]})]})})}var Hn=(0,c.forwardRef)(Un),na=Te.Z.Option,aa={labelCol:{span:4},wrapperCol:{span:18}},Mn=function(d,n){var s=d.data,v=d.type,O=a.Z.useForm(),ae=ue()(O,1),m=ae[0],w=(0,c.useState)([]),D=ue()(w,2),g=D[0],V=D[1],te=(0,c.useReducer)(function(y){return y+1},0),ie=ue()(te,2),pe=ie[1],Ze=(0,c.useState)(!0),he=ue()(Ze,2),x=he[0],K=he[1],P=(0,Ae.DP)(),le=(0,c.useRef)(null),T=(0,hr.useModel)("@@initialState"),b=T.initialState,E=b.currentUser,h=E===void 0?{}:E,k=(0,c.useRef)([]),G=(0,c.useRef)(null),$=(0,c.useRef)(null),Q=(0,c.useRef)([]),W=(0,c.useRef)({}),de=(0,c.useRef)(0),se=(0,Ur.v9)(function(y){var r=y.pipeline;return r}),Se=(0,Ur.I0)(),Pe=(0,c.useRef)(1),C=P.pipelineId,Le=P.from,Ye=se.list.findIndex(function(y){return y.id===C});(0,c.useImperativeHandle)(n,function(){return{getFormValue:X,formScrollToField:cn}}),(0,c.useEffect)(function(){t()},[s]),(0,c.useEffect)(function(){B()},[g]);var B=function(){var y=we()(M()().mark(function r(){var l;return M()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:Q.current=[],l=g.filter(function(F){return F.type!=="component"}),l.forEach(function(F){F.id+="",Q.current.push(F)});case 3:case"end":return f.stop()}},r)}));return function(){return y.apply(this,arguments)}}(),t=function(){var r;m.setFieldValue("from",2);var l=((r=s.setting)===null||r===void 0?void 0:r.pipeline_variable)||[],j=l.map(function(f,F){return f.isArrowRotate=!0,f});V(j)},N=function(r){var l=r.filter(function(I){return I.type==="string"||I.type==="bool"}),j=r.filter(function(I){return I.type==="component"}),f=r.filter(function(I){return I.type==="choose"}),F=r.filter(function(I){return I.type==="repo"});return[].concat(q()(j),q()(F),q()(l),q()(f))},X=function(){var y=we()(M()().mark(function r(l){var j,f,F,I,U,H,oe,z,ne,pr;return M()().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(j=[],f=[],!G.current){Ee.next=14;break}return Ee.next=5,G.current.componentFormVaild();case 5:if(f=Ee.sent,!(f.length<=0)){Ee.next=8;break}return Ee.abrupt("return",Promise.reject({values:{from:2},errorFields:[{errors:["\u8BF7\u81F3\u5C11\u6DFB\u52A0\u4E00\u4E2A\u7EC4\u4EF6"]}]}));case 8:if(F=f.find(function(We){return We.checked}),F){Ee.next=11;break}return Ee.abrupt("return",Promise.reject({values:{from:2},errorFields:[{errors:["\u8BF7\u9ED8\u8BA4\u9009\u62E9\u4E00\u4E2A\u7EC4\u4EF6"]}]}));case 11:I=g.find(function(We){return We.type==="component"}),U=g.findIndex(function(We){return We.type==="component"}),j[U]={type:I.type,prompt_on_trigger:I.prompt_on_trigger,componentDefault:F};case 14:if(H=k.current.filter(Boolean),!(H.length>0)){Ee.next=23;break}oe=M()().mark(function We(){var an,vr,$r;return M()().wrap(function(wr){for(;;)switch(wr.prev=wr.next){case 0:return an=H[z],wr.next=3,an.componentFormVaild();case 3:vr=wr.sent,$r=g.findIndex(function(Br){return Br.id===vr.id}),$r<0?j.push(vr):j[$r]=vr;case 6:case"end":return wr.stop()}},We)}),z=0;case 18:if(!(z<H.length)){Ee.next=23;break}return Ee.delegateYield(oe(),"t0",20);case 20:z++,Ee.next=18;break;case 23:return Ee.next=25,m.validateFields();case 25:return ne=Ee.sent,g.filter(function(We){return We.type!=="component"&&We.type!=="repo"}).forEach(function(We,an){var vr=We.id+"",$r=Object.keys(ne),fn=$r.filter(function(Br){var Xn=Br.slice(0,vr.length);if(Xn===vr)return Br}),wr=g.findIndex(function(Br){return Br.id==We.id});j[wr]=Fe(vr,fn,ne)}),pr={env:j},f.length>0&&(pr.envComponentList=f),pr.default_trigger_info=Ve(pr.env),Ee.abrupt("return",pr);case 31:case"end":return Ee.stop()}},r)}));return function(l){return y.apply(this,arguments)}}(),ce=function(r,l){var j=[],f=r.filter(function(F){return F.prompt_on_trigger&&F.type==="repo"}).reverse();f.forEach(function(F,I){var U=F.repo,H=U[0],oe=U[1],z=U[2],ne={index:I+1+"",platform:H["repo-type"],base_info:{key:H["git_url-name"]||"",name:H["repo-name"]||"",repo_id:H["repo-id"]||"",repo_url:H["repo-url"]||""}};switch(oe["ref-isBranch"]){case"branch":ne.branch_patchset={type:"branch",key:oe["ref-name"],ref:oe.ref},ne.commit={sha:z.sha||"",key:z["sha-name"]||""};break;case"patchset":ne.branch_patchset={type:"patchset",key:oe["ref-name"],patchset:oe["ref-patchset"]};break;case"tag":ne.branch_patchset={type:"tag",key:oe["ref-name"],tag:oe["ref-tag"]};break}j.push(ne)}),l.push({repo_info:j})},Y=function(r,l){var j=r.filter(function(f){return f.prompt_on_trigger&&f.type!=="repo"});j.forEach(function(f){var F=f.type,I=f.name,U=f.display_name,H=f.description,oe=f.default,z={key:I,type:F,value:oe,description:H,display_name:U};F==="date"&&oe&&(z.value=Ce()(z.value).format("YYYY-MM-DD HH:mm:ss")),l.push(z)})},Ve=function(r){var l=[];return ce(r,l),Y(r,l),l},Fe=function(r,l,j){var f={id:r};return l.map(function(F){var I=j[F];f[F.slice(r.length+1,F.length)]=I}),f},Ie=function(r){var l=r||document.documentElement||document.body,j=l.scrollHeight,f=l.clientHeight,F=l.scrollTop,I=Date.now(),U=500;function H(){var oe=Date.now()-I,z=oe/U,ne=j-f;l.scrollTo(0,F-ne*z),oe<U&&requestAnimationFrame(H)}H()},ye=function(r){if(v===2){Vr.ZP.info("\u9884\u89C8\u9875\u9762\u4E0D\u53EF\u7F16\u8F91\uFF0C\u8BF7\u70B9\u51FB\u7F16\u8F91\u6309\u94AE\u8DF3\u8F6C\u81F3\u7F16\u8F91\u9875\u9762\u65B0\u589E");return}var l=document.querySelector("#flowline-modify-base-right-container");Ie(l),r==="repo"&&(de.current+=1);var j={id:Math.random(),isArrowRotate:!0,name:"param".concat(g.length+1),default:"",description:"",type:r,prompt_on_trigger:!0,isNew:!0};g.unshift(j),V(q()(g))},ge=function(r){r.isArrowRotate=!r.isArrowRotate,g.every(function(l){return l.isArrowRotate===!0})&&K(!0),g.every(function(l){return l.isArrowRotate===!1})&&K(!1),V(q()(g))},Xe=function(r,l){var j,f=se.list[Ye],F=(j=f.setting)===null||j===void 0||(j=j.extra_data)===null||j===void 0?void 0:j.relationList;F&&F.forEach(function(I,U){var H=I.options,oe=[];H.forEach(function(ne,pr){ne.includes(l.id)||oe.push(ne)}),F[U].options=oe;var z=oe.find(function(ne){return ne===I.value});I.value=z||oe[0],oe.length<=1&&F.splice(U,1)}),Se({type:"pipeline/setList",payload:{list:q()(se.list)}}),g.splice(r,1),V(q()(g)),m.validateFields()},Be=function(r,l,j,f){if(!l)return r.field.includes("-ref")||r.field.includes("-sha")?Promise.resolve():Promise.reject("\u8BF7\u8F93\u5165");if(!/^[^\u4e00-\u9fa5\s]*$/.test(l))return Promise.reject("\u4E0D\u80FD\u542B\u6709\u4E2D\u6587\u3001\u7A7A\u683C");if(xe.includes(l))return Promise.reject("\u4E0E\u7CFB\u7EDF\u4FDD\u7559\u5173\u952E\u5B57\u51B2\u7A81");var F=[];g.map(function(z){if(z.type==="repo"){var ne=g.filter(function(Ee){return Ee.type==="repo"}),pr=ne.findIndex(function(Ee){return Ee.id===z.id}),Hr=k.current[pr];F.push({key:z.id+"-repoType-git_url-name",value:Hr.getFormValue(z.id+"-repoType-git_url-name")}),F.push({key:z.id+"-repoType-ref-name",value:Hr.getFormValue(z.id+"-repoType-ref-name")}),F.push({key:z.id+"-repoType-sha-name",value:Hr.getFormValue(z.id+"-repoType-sha-name")})}else F.push({key:z.id+"-name",value:m.getFieldValue(z.id+"-name")})});var I=Ir(F.filter(function(z){return z.value}));if(I)for(var U=F.filter(function(z){return z.value===I}),H=0;H<U.length;H++){var oe=U[H].key;if(r.field===oe)return Promise.reject("\u540D\u79F0\u91CD\u590D")}return Promise.resolve()},Zr=function(r,l,j){switch(g[j].type=r,V(q()(g)),m.validateFields(g.map(function(f){return f.id+"-type"})),m.setFieldValue(l+"-default",void 0),r){case"string":m.setFieldValue(l+"-default","");break;case"bool":m.setFieldValue(l+"-default",!0);break;case"choose":m.setFieldValue(l+"-default",void 0);break;case"ref":m.setFieldValue(l+"-default","master");break}},fr=function(r,l,j){if(!l)return Promise.reject("\u8BF7\u8F93\u5165");var f=g.map(function(H){return m.getFieldValue(H.id+"-type")}),F=f.filter(function(H){return H==="ref"}).length,I=f.filter(function(H){return H==="git_url"}).length,U=f.filter(function(H){return H==="sha"}).length;return l==="ref"&&F>1?Promise.reject("Gerrit \u5206\u652F \u53EA\u80FD\u4FDD\u7559\u4E00\u4E2A"):l==="git_url"&&I>1?Promise.reject("\u4EE3\u7801\u5E93 \u53EA\u80FD\u4FDD\u7559\u4E00\u4E2A"):l==="sha"&&U>1?Promise.reject("Commit Id \u53EA\u80FD\u4FDD\u7559\u4E00\u4E2A"):(l==="ref"||l==="sha")&&(F===1||U===1)&&I<1?Promise.reject("\u9009\u62E9 Gerrit \u5206\u652F \u6216\u8005 Commit Id \u9700\u8981\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\u73AF\u5883\u53D8\u91CF"):l==="git_url"&&I===1&&F<1?Promise.reject("\u9009\u62E9\u4ED3\u5E93\u540E\uFF0C\u9700\u8981\u9009\u62E9\u4E00\u4E2A GIT \u5206\u652F\u73AF\u5883\u53D8\u91CF"):Promise.resolve()};function Ir(y){for(var r=new Map,l=0;l<y.length;l++){var j=y[l].value;if(r.has(j))return j;r.set(j,!0)}return null}var ee=function(){m.validateFields()},Z=function(r){r.prompt_on_trigger=!r.prompt_on_trigger,V(q()(g))},J=function(r){var l=r.default,j=r.id+"-type",f=m.getFieldValue(j);switch(f){case"string":return(0,e.jsx)(jn,{item:r,validator:Be,nameBlur:ee});case"bool":return(0,e.jsx)(yn,{item:r,validator:Be,nameBlur:ee});case"choose":return(0,e.jsx)(wn,{item:r,validator:Be,nameBlur:ee,form:m,ref:le});case"multiple":return(0,e.jsx)(Nn,{item:r,validator:Be,nameBlur:ee,form:m,ref:le});case"date":return(0,e.jsx)(Cn,{item:r,validator:Be,nameBlur:ee})}return(0,e.jsx)(e.Fragment,{})},R=function(r){var l=g.filter(function(f){return f.type==="repo"}),j=l.findIndex(function(f){return f.id===r.id});return(0,e.jsx)(fe,{ref:function(F){return k.current[j]=F},item:r,form:m,configList:g,validator:Be,nameBlur:ee,type:v,handleRepoDisplay:be})},o=function(r){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"flex-end",style:{padding:"0 20px"},children:(0,e.jsx)(a.Z.Item,{label:"",noStyle:!0,name:r.id+"-prompt_on_trigger",initialValue:r.prompt_on_trigger,valuePropName:"checked",children:(0,e.jsx)(me.Z,{onChange:function(){return Z(r)},children:"\u6267\u884C\u65F6\u663E\u793A"})})}),(0,e.jsx)(hn,{ref:G,data:s,parentType:v})]})},p=function(r){return(0,e.jsx)(e.Fragment,{})},S=function(r){var l=r.prompt_on_trigger,j=r.isMoreOptions,f=r.is_required;return(0,e.jsxs)("div",{className:"flex-start",children:[(0,e.jsx)(a.Z.Item,{label:" ",name:r.id+"-prompt_on_trigger",initialValue:l,valuePropName:"checked",children:(0,e.jsx)(me.Z,{children:"\u6267\u884C\u65F6\u663E\u793A"})}),"\xA0\xA0\xA0",(0,e.jsx)(a.Z.Item,{label:"",noStyle:!0,name:r.id+"-isMoreOptions",initialValue:j,valuePropName:"checked",children:(0,e.jsx)(me.Z,{children:"\u9AD8\u7EA7\u9009\u9879"})}),(0,e.jsx)(a.Z.Item,{label:"",noStyle:!0,name:r.id+"-is_required",initialValue:f,valuePropName:"checked",children:(0,e.jsx)(me.Z,{children:"\u5FC5\u586B"})})]})},re=function(r){var l=r.name,j=r.isArrowRotate,f=r.description,F=r.type,I=r.default,U=r.prompt_on_trigger;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)(a.Z.Item,{name:r.id+"-type",initialValue:"upload",noStyle:!0}),(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"\u53D8\u91CF\u7C7B\u578B",name:r.id+"-type",initialValue:F||"string",rules:[{required:!0,message:""},{validator:fr}],children:(0,e.jsx)(Te.Z,{options:[{label:"\u6587\u4EF6",value:"upload"}]})})}),(0,e.jsx)("div",{className:"row-right",children:S(r)})]}),(0,e.jsx)(Bn,{item:r,form:m,type:v,validator:Be,nameBlur:ee}),(0,e.jsx)("div",{className:"item-row flex-space-between",children:(0,e.jsx)("div",{className:"all",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:r.id+"-description",initialValue:f,className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:f,hideTitle:!0,isSimple:!0,disabled:!(0,Ae.Hb)(h,s==null?void 0:s.creator_user_id)||v!==1})})})})]})},De=function(r){var l=r.name,j=r.isArrowRotate,f=r.description,F=r.type,I=r.default,U=r.prompt_on_trigger;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)(a.Z.Item,{name:r.id+"-type",initialValue:"fileContent",noStyle:!0}),(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"\u6587\u4EF6\u5185\u5BB9",name:r.id+"-type",initialValue:F||"string",rules:[{required:!0,message:""},{validator:fr}],children:(0,e.jsx)(Te.Z,{options:[{label:"\u6587\u4EF6\u5185\u5BB9",value:"fileContent"}]})})}),(0,e.jsx)("div",{className:"row-right",children:S(r)})]}),(0,e.jsx)(Rn,{item:r,form:m,type:v,validator:Be,nameBlur:ee}),(0,e.jsx)("div",{className:"item-row flex-space-between",children:(0,e.jsx)("div",{className:"all",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:r.id+"-description",initialValue:f,className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:f,hideTitle:!0,isSimple:!0,disabled:!(0,Ae.Hb)(h,s==null?void 0:s.creator_user_id)||v!==1})})})})]})},He=function(r){var l=r.name,j=r.isArrowRotate,f=r.description,F=r.type,I=r.default,U=r.prompt_on_trigger;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)(a.Z.Item,{name:r.id+"-type",initialValue:"user",noStyle:!0}),(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"\u7528\u6237",name:r.id+"-type",initialValue:F,rules:[{required:!0,message:""},{validator:fr}],children:(0,e.jsx)(Te.Z,{options:[{label:"\u7528\u6237",value:"user"}]})})}),(0,e.jsx)("div",{className:"row-right",children:S(r)})]}),(0,e.jsx)(Ln,{item:r,form:m,type:v,validator:Be,nameBlur:ee}),(0,e.jsx)("div",{className:"item-row flex-space-between",children:(0,e.jsx)("div",{className:"all",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:r.id+"-description",initialValue:f,className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:f,hideTitle:!0,isSimple:!0,disabled:!(0,Ae.Hb)(h,s==null?void 0:s.creator_user_id)||v!==1})})})})]})},Je=function(r,l){var j=r.name,f=r.isArrowRotate,F=r.description,I=r.type,U=r.default,H=r.prompt_on_trigger;switch(I){case"repo":return R(r);case"component":return o(r);case"upload":return re(r);case"user":return He(r);case"fileContent":return De(r)}return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"item-row flex-space-between",children:[(0,e.jsx)("div",{className:"row-left",children:(0,e.jsx)(a.Z.Item,{label:"\u53D8\u91CF\u7C7B\u578B",name:r.id+"-type",initialValue:I||"string",rules:[{required:!0,message:""},{validator:fr}],children:(0,e.jsx)(Te.Z,{options:Qe,onChange:function(z){return Zr(z,r.id,l)}})})}),(0,e.jsx)("div",{className:"row-right",children:S(r)})]}),(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:function(z,ne){return z[r.id+"-type"]!==ne[r.id+"-type"]},children:function(){return J(r)}}),(0,e.jsx)("div",{className:"item-row flex-space-between",children:(0,e.jsx)("div",{className:"all",children:(0,e.jsx)(a.Z.Item,{label:"\u63CF\u8FF0",name:r.id+"-description",initialValue:F,className:"flowLine-desc-editor",children:(0,e.jsx)(qe.Z,{title:"",content:F,hideTitle:!0,isSimple:!0,disabled:!(0,Ae.Hb)(h,s==null?void 0:s.creator_user_id)||v!==1})})})})]})},be=function(r,l){m.setFieldValue(r,l)},Oe=function(r,l){var j=m.getFieldValue(l.id+"-name");switch(r){case"repo":var f=g.filter(function(U){return U.type==="repo"}),F=m.getFieldValue(l.id+"-repoType-repo-display_name"),I=F||"\u4ED3\u5E93"+(f.length+1-(f.findIndex(function(U){return U.id===l.id})+1));j=(0,e.jsxs)(e.Fragment,{children:[I,(0,e.jsx)(a.Z.Item,{label:"",style:{margin:"0",padding:"0",display:"none"},name:l.id+"-repoType-repo-display_name",children:(0,e.jsx)(A.Z,{onClick:function(H){return H.stopPropagation()},style:{width:"40%"}})})]});break;case"component":j="\u7EC4\u4EF6";break;default:break}return j},_e=function(r){if(r.stopPropagation(),r.preventDefault(),!!W.current.isDragStart){var l=r.clientY,j=r.target.closest(".form-config-item"),f=W.current,F=f.dragElement,I=f.dragStartY,U=f.dragBox;if(F&&j&&j.dataset.id!==F.dataset.id){var H=j.closest(".form-config-item-container");H&&(I>l?H.insertBefore(U,j):H.insertBefore(U,j.nextElementSibling),W.current.dragStartY=l)}}},Lr=function(r){r.stopPropagation(),W.current.isStepDragStart=!1;var l=r.clientY;W.current.dragBox.style.opacity="1",nn(!1);var j=Array.from(document.querySelectorAll(".form-config-item")),f=[];j.forEach(function(F){var I=g.find(function(U){return U.id===F.dataset.id});I&&f.push(I)}),V(f)},Or=function(r){r.stopPropagation(),g.forEach(function(j){return j.isArrowRotate=!1}),V(q()(g)),K(!1);var l=r.target;W.current.isDragStart=!0,W.current.dragBox=l.parentNode.parentNode.parentNode,W.current.dragElement=l,W.current.dragStartY=r.clientX,W.current.dragBox.style.opacity=".3",nn(!0)},nn=function(r){Array.from(document.querySelectorAll(".form-config-item")).forEach(function(l){l.draggable=r})},dn=function(r,l){var j=r.name,f=r.isArrowRotate,F=r.description,I=r.type,U=r.default,H=r.prompt_on_trigger,oe=r.isNew;return(0,e.jsxs)("div",{className:"form-config-item ".concat(oe&&"form-config-item-blink"),"data-id":r.id,onDragEnter:_e,"data-current-index":"".concat(l),children:[(0,e.jsxs)("header",{className:"item-header flex-space-between",onClick:function(ne){ne.stopPropagation(),ge(r)},children:[(0,e.jsxs)("div",{style:{width:"100%"},className:"flex-start",children:[(0,e.jsx)("div",{onDragEnd:Lr,onDragStart:Or,draggable:v==1&&I!=="repo","data-id":r.id,"data-current-index":"".concat(l),children:(0,e.jsx)(cr.Z,{title:I==="repo"?"\u6682\u4E0D\u652F\u6301\u4ED3\u5E93\u62D6\u62FD":"",children:(0,e.jsx)(kr.Z,{className:"move",style:{cursor:I==="repo"?"default":"move"}})})}),(0,e.jsx)(jr.Z,{className:"arrow ".concat(f&&"arrow-rotate")}),(0,e.jsx)(a.Z.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return(0,e.jsx)("span",{className:"form-config-item-name",style:{marginLeft:"10px"},children:Oe(I,r)})}})]}),!(!(0,Ae.Hb)(h,s==null?void 0:s.creator_user_id)||v!==1)&&(0,e.jsx)("div",{className:"remove flex-center",onClick:function(){return Xe(l,r)},children:(0,e.jsx)(Sr.Z,{})})]}),(0,e.jsx)("div",{style:{display:f?"block":"none"},children:Je(r,l)})]},r.id)},Wn=function(){var y=we()(M()().mark(function r(){var l,j,f,F,I,U,H,oe;return M()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.prev=0,ne.next=3,X("relation");case 3:l=ne.sent,$.current.open(l.env),ne.next=15;break;case 7:ne.prev=7,ne.t0=ne.catch(0),F=ne.t0.errorFields,I=F===void 0?[]:F,U=((j=I[0])===null||j===void 0?void 0:j.errors[0])||((f=I[0])===null||f===void 0?void 0:f.errors[1]),U.replace(/\s/g,"")||I.length>1&&(U=(H=I[1])===null||H===void 0?void 0:H.errors[0]),U&&Vr.ZP.error(U||"",2),oe=ne.t0.errorFields[0].name[0],cn(oe);case 15:case"end":return ne.stop()}},r,null,[[0,7]])}));return function(){return y.apply(this,arguments)}}(),cn=function(r){m.scrollToField(r,{behavior:"smooth",block:"start"})},zn=function(){return(0,e.jsx)("div",{className:"form-config-item-container",children:g.map(function(r,l){return dn(r,l)})})},mn=[{key:"1",label:(0,e.jsx)("div",{onClick:function(){return ye("string")},children:"\u5B57\u7B26\u4E32"})},{key:"2",label:(0,e.jsx)("div",{onClick:function(){return ye("bool")},children:"\u5E03\u5C14\u503C"})},{key:"5",label:(0,e.jsx)("div",{onClick:function(){return ye("choose")},children:"\u5355\u9009\u6846"})},{key:"10",label:(0,e.jsx)("div",{onClick:function(){return ye("multiple")},children:"\u591A\u9009\u6846"})},{key:"6",label:(0,e.jsx)("div",{onClick:function(){return ye("date")},children:"\u65F6\u95F4\u70B9"})},{key:"7",label:(0,e.jsx)("div",{onClick:function(){return ye("upload")},children:"\u6587\u4EF6"})},{key:"8",label:(0,e.jsx)("div",{onClick:function(){return ye("fileContent")},children:"\u6587\u4EF6\u5185\u5BB9"})},{key:"9",label:(0,e.jsx)("div",{onClick:function(){return ye("user")},children:"\u7528\u6237"})},{key:"3",label:(0,e.jsx)("div",{onClick:function(){return ye("repo")},children:"\u4ED3\u5E93"})}];!g.find(function(y){return y.type==="component"})&&(C==="p-66626b6764c443ccae120bb2b841d0ea"||C==="p-8f982dd63f5d4f478575604a33d4f5db")&&mn.push({key:"4",label:(0,e.jsx)("div",{onClick:function(){return ye("component")},children:"\u7EC4\u4EF6"})});var Qn=function(){g.forEach(function(r){return r.isArrowRotate=!x}),K(!x)};return(0,e.jsxs)("div",{className:"modify-form-environmentVariable-config",children:[(0,e.jsxs)(a.Z,{layout:"vertical",form:m,name:"control-hooks",className:"config-form",disabled:!(0,Ae.Hb)(h,s==null?void 0:s.creator_user_id)||v!==1,children:[(0,e.jsx)(a.Z.Item,{noStyle:!0,name:"from",label:""}),(0,e.jsx)(Rr.Z,{menu:{items:mn},placement:"bottom",children:(0,e.jsx)(nr.ZP,{icon:(0,e.jsx)(ir.Z,{}),type:"primary",className:"add",children:"\u65B0\u589E"})}),(0,e.jsx)(nr.ZP,{icon:(0,e.jsx)(Pr.Z,{}),type:"primary",disabled:!1,ghost:!0,className:"relation",onClick:function(){return Wn()},children:"\u5173\u7CFB"}),g.length>0&&(0,e.jsx)(nr.ZP,{className:"expand-button flex-start",disabled:!1,onClick:Qn,children:(0,e.jsxs)("div",{className:"flex-start",children:[(0,e.jsx)("div",{style:{marginRight:"6px",marginLeft:"-2px"},children:(0,e.jsx)(ze.Z,{className:"expand ".concat(!x&&"expand-active")})}),x?"\u6298\u53E0":"\u5C55\u5F00"]})}),(0,e.jsx)("div",{className:"form-config-container flex-center",children:zn()})]}),(0,e.jsx)(Hn,{ref:$,getFormValue:X,type:v})]})},Gn=(0,c.forwardRef)(Mn);function Yn(i,d){var n=i.data,s=i.setTabIndex,v=i.type,O=i.defaultSwitchTabIndex,ae=(0,c.useState)(0),m=ue()(ae,2),w=m[0],D=m[1],g=(0,Ae.DP)(),V=g.from,te=(0,c.useRef)(null),ie=(0,c.useRef)(null),pe=(0,c.useRef)(null);(0,c.useImperativeHandle)(d,function(){return{getFormValue:Ze}}),(0,c.useEffect)(function(){V==="packagingService"&&D(2)},[]);var Ze=function(){var P=we()(M()().mark(function le(){return M()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",new Promise(function(){var E=we()(M()().mark(function h(k,G){var $,Q,W,de,se,Se,Pe,C,Le;return M()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.prev=0,B.next=3,te.current.getFormValue();case 3:return $=B.sent,B.next=6,ie.current.getFormValue();case 6:return Q=B.sent,B.next=9,pe.current.getFormValue();case 9:W=B.sent,k(_()(_()(_()({},$),Q),W)),B.next=24;break;case 13:B.prev=13,B.t0=B.catch(0),D(B.t0.values.from),s(O===void 0?1:O),se=B.t0.errorFields,Se=se===void 0?[]:se,Pe=(de=Se[0])===null||de===void 0?void 0:de.errors[0],Pe.replace(/\s/g,"")||Se.length>1&&(Pe=(C=Se[1])===null||C===void 0?void 0:C.errors[0]),Pe&&Vr.ZP.error(Pe||"",2),Le=B.t0.errorFields[0].name[0],pe.current.formScrollToField(Le),G();case 24:case"end":return B.stop()}},h,null,[[0,13]])}));return function(h,k){return E.apply(this,arguments)}}()));case 1:case"end":return b.stop()}},le)}));return function(){return P.apply(this,arguments)}}(),he=function(le){D(le)},x=function(){return(0,e.jsxs)("ul",{className:"config-left",children:[(0,e.jsx)("li",{className:"menu-item ".concat(w===0&&"config-menu-action"),onClick:function(){return he(0)},children:"\u57FA\u672C\u4FE1\u606F"}),(0,e.jsx)("li",{className:"menu-item ".concat(w===1&&"config-menu-action"),onClick:function(){return he(1)},children:"\u8FD0\u884C\u8BBE\u7F6E"}),(0,e.jsx)("li",{className:"menu-item ".concat(w===2&&"config-menu-action"),onClick:function(){return he(2)},children:"\u6D41\u6C34\u7EBF\u53D8\u91CF"})]})},K=function(){return(0,e.jsxs)("div",{className:"config-right common-scroll-bar",id:"flowline-modify-base-right-container",children:[(0,e.jsx)("div",{className:"config-right-option ".concat(w===0&&"config-right-option-show"),children:(0,e.jsx)(on,{ref:te,data:n,type:v})}),(0,e.jsx)("div",{className:"config-right-option ".concat(w===1&&"config-right-option-show"),children:(0,e.jsx)(Nr,{ref:ie,data:n,type:v})}),(0,e.jsx)("div",{className:"config-right-option ".concat(w===2&&"config-right-option-show"),children:(0,e.jsx)(Gn,{ref:pe,data:n,type:v})})]})};return(0,e.jsxs)("div",{className:"modify-base-config-container flex-start",children:[x(),K()]})}var Kn=(0,c.forwardRef)(Yn)},12570:function(pn,Mr,u){u.d(Mr,{Z:function(){return nr}});var Gr=u(15009),M=u.n(Gr),Yr=u(99289),_=u.n(Yr),Kr=u(5574),we=u.n(Kr),$e=u(62435),ue=u(68872),c=u(74877),Vr=u(97857),Te=u.n(Vr),A=u(94060),a=u(96456),me=u(81182),Ae=u(74330),qe=u(32983),hr=u(84567),e=u(88026),tn=u(50888),ln=u(23279),Wr=u.n(ln),zr=u(11238),on=function(ze){return request("/api/test",{method:"get",params:ze})},Ne=function(ze){return(0,zr.ZP)("/api/devices/info/find_user",{method:"get",params:ze})},L=u(86074),Qr=A.Z.Option,Xr=a.Z.TextArea,Jr={labelCol:{span:6},wrapperCol:{span:16}},_r=function(ze,Me){var ir=ze.data,lr=ze.type,Ar=me.Z.useForm(),Dr=we()(Ar,1),er=Dr[0],Ke=(0,$e.useState)([]),gr=we()(Ke,2),sr=gr[0],en=gr[1],Er=(0,$e.useState)(!1),dr=we()(Er,2),xr=dr[0],Nr=dr[1],cr=(0,$e.useState)(""),Rr=we()(cr,2),kr=Rr[0],jr=Rr[1],Sr=(0,e.useModel)("@@initialState"),Pr=Sr.initialState,Qe=Pr.currentUser,xe=Qe===void 0?{}:Qe;(0,$e.useImperativeHandle)(Me,function(){return{getFormValue:Ge,setFormValue:Ce}}),(0,$e.useEffect)(function(){Tr()},[]);var ar=function(){},Ce=function(ve){er.setFieldValue("from",2);for(var ke in ve){var fe=ve[ke];er.setFieldValue(ke,fe)}},Ge=function(){return er.validateFields()},Re=function(ve){console.log(ve)},Fr=function(ve){er.setFieldValue("receiver",ve)},Tr=function(){var je=_()(M()().mark(function ve(){var ke,fe,br=arguments;return M()().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return ke=br.length>0&&br[0]!==void 0?br[0]:"",jr(ke),Nr(!0),Ue.prev=3,Ue.next=6,Ne({username:ke});case 6:fe=Ue.sent,en(fe.map(function(Cr){return Cr.value=Cr.user_id,Cr.label=Cr.username,Cr})),Ue.next=13;break;case 10:Ue.prev=10,Ue.t0=Ue.catch(3),console.log(Ue.t0);case 13:return Ue.prev=13,Nr(!1),Ue.finish(13);case 16:case"end":return Ue.stop()}},ve,null,[[3,10,13,16]])}));return function(){return je.apply(this,arguments)}}(),or=Wr()(Tr,500),rr=function(){return xr?(0,L.jsx)(Ae.Z,{indicator:(0,L.jsx)(tn.Z,{})}):kr&&sr.length===0?(0,L.jsx)(qe.Z,{image:qe.Z.PRESENTED_IMAGE_SIMPLE}):"\u53EF\u8F93\u5165\u5173\u952E\u5B57\u641C\u7D22"},ur=function(ve){ve.length&&er.validateFields(["extra_email_group"])},yr=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(ve.length<=0)return!0;for(var ke=0;ke<ve.length;ke++){var fe=ve[ke];if(!fe.includes("@"))return!1;var br=fe.split("@")[1];if(br!=="enflame-tech.com")return!1}return!0},mr=function(ve,ke){return yr(ke)?Promise.resolve():Promise.reject("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u4EF6\u683C\u5F0F\uFF0C\u4E14\u4EE5 @enflame-tech.com \u7ED3\u5C3E")};return(0,L.jsx)("div",{className:"flex-center modify-form-run-config",children:(0,L.jsxs)(me.Z,Te()(Te()({},Jr),{},{form:er,name:"control-hooks",onFinish:Re,className:"run-config-form",disabled:!(0,c.Hb)(xe,ir==null?void 0:ir.creator_user_id)||lr!==1,children:[(0,L.jsx)(me.Z.Item,{name:"from",label:""}),(0,L.jsx)(me.Z.Item,{name:"notifyIndex",label:"",noStyle:!0}),(0,L.jsx)(me.Z.Item,{name:"method",label:"\u901A\u77E5\u65B9\u5F0F",required:!0,children:(0,L.jsxs)(hr.Z.Group,{children:[(0,L.jsx)(hr.Z,{value:"wecom",children:"\u4F01\u4E1A\u5FAE\u4FE1\u901A\u77E5"}),(0,L.jsx)(hr.Z,{value:"email",children:"\u90AE\u4EF6"})]})}),(0,L.jsx)(me.Z.Item,{name:"receiver",label:"\u9644\u52A0\u901A\u77E5\u4EBA",children:(0,L.jsx)(A.Z,{allowClear:!0,mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u9644\u52A0\u901A\u77E5\u4EBA",showSearch:!0,onChange:Fr,optionFilterProp:"children",filterOption:!1,className:"multiple-select-input-minWidth",onSearch:function(ve){return or(ve)},notFoundContent:rr(),children:sr==null?void 0:sr.map(function(je){return(0,L.jsx)(Qr,{value:je.value,label:je.label,children:(0,L.jsxs)("div",{className:"demo-option-label-item",title:"".concat(je.label," ").concat(je.user_id),children:[(0,L.jsx)("span",{role:"img","aria-label":"China",children:je.label}),(0,L.jsxs)("span",{children:["\xA0\xA0\xA0",je.user_id]})]})})})})}),(0,L.jsx)(me.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(){var ve=er.getFieldValue("method")||[];return console.log(ve),ve.includes("email")?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(me.Z.Item,{name:"extra_email_group",label:"\u6284\u9001",rules:[{validator:mr}],children:(0,L.jsx)(A.Z,{mode:"tags",allowClear:!0,placeholder:"Outlook \u90AE\u7BB1\u5730\u5740\uFF0C\u56DE\u8F66\u540E\u8F93\u5165\u4E0B\u4E00\u4E2A",options:[],onChange:ur,className:"multiple-select-input-minWidth",onFocus:function(){return console.log(12)},open:!1})}),(0,L.jsx)(me.Z.Item,{name:"email_title",label:"\u90AE\u4EF6\u6807\u9898",initialValue:"\u3010\u6548\u80FD\u5E73\u53F0\u3011\u60A8\u7684\u6D41\u6C34\u7EBF\uFF08$pipeline_name\uFF09\u8FD0\u884C\u7ED3\u675F",children:(0,L.jsx)(a.Z,{placeholder:"\u8BF7\u8F93\u5165\u90AE\u4EF6\u6807\u9898"})})]}):(0,L.jsx)(L.Fragment,{})}}),(0,L.jsx)(me.Z.Item,{name:"content",label:"\u901A\u77E5\u5185\u5BB9\uFF08Markdown\uFF09",children:(0,L.jsx)(Xr,{placeholder:"\u8BF7\u8F93\u5165",autoSize:{minRows:3}})})]}))})},q=(0,$e.forwardRef)(_r);function qr(tr,ze){var Me=tr.data,ir=tr.setTabIndex,lr=tr.type,Ar=tr.defaultSwitchTabIndex,Dr=(0,$e.useState)(0),er=we()(Dr,2),Ke=er[0],gr=er[1],sr=(0,c.DP)(),en=sr.from,Er=(0,$e.useRef)(null),dr=(0,$e.useRef)(null),xr=(0,$e.useRef)(null);(0,$e.useImperativeHandle)(ze,function(){return{getFormValue:kr}}),(0,$e.useEffect)(function(){Nr()},[Me]);var Nr=function(){var xe;console.log(Me);var ar=(xe=Me.setting)===null||xe===void 0?void 0:xe.notification,Ce=ar.success,Ge=ar.failed,Re=ar.canceled;Re||(Re={content:"",method:["wecom"],receiver:[]}),cr(Ce,!1),cr(Ge,!0),cr(Re,!0),Me.setting.default_notification_content&&(Ce.content=Ce.content||Me.setting.default_notification_content,Ge.content=Ge.content||Me.setting.default_notification_content,Re.content=Re.content||Me.setting.default_notification_content),Ce.notifyIndex=0,Ge.notifyIndex=1,Re.notifyIndex=2,Er.current.setFormValue(Ce),dr.current.setFormValue(Ge),xr.current.setFormValue(Re)},cr=function(xe,ar){Array.isArray(xe.method)||(xe.method=["wecom"]),xe.method||(xe.method=["wecom"])},Rr=function(xe,ar){for(var Ce in xe){var Ge=xe[Ce];ar[Ce]=Ge}},kr=function(){var Qe=_()(M()().mark(function xe(){return M()().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.abrupt("return",new Promise(function(){var Ge=_()(M()().mark(function Re(Fr,Tr){var or,rr,ur,yr,mr,je,ve;return M()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.prev=0,fe.next=3,Er.current.getFormValue();case 3:return or=fe.sent,fe.next=6,dr.current.getFormValue();case 6:return rr=fe.sent,fe.next=9,xr.current.getFormValue();case 9:ur=fe.sent,delete or.from,delete rr.from,delete ur.from,delete or.notifyIndex,delete rr.notifyIndex,delete ur.notifyIndex,delete or.wecom,delete rr.wecom,delete ur.wecom,Fr({success:or,failed:rr,canceled:ur}),fe.next=30;break;case 22:fe.prev=22,fe.t0=fe.catch(0),ir(fe.t0.values.from),gr(fe.t0.values.notifyIndex),mr=fe.t0.errorFields,je=mr===void 0?[]:mr,ve=(yr=je[0])===null||yr===void 0?void 0:yr.errors[0],ve&&ue.ZP.error(ve||"",2),Tr();case 30:case"end":return fe.stop()}},Re,null,[[0,22]])}));return function(Re,Fr){return Ge.apply(this,arguments)}}()));case 1:case"end":return Ce.stop()}},xe)}));return function(){return Qe.apply(this,arguments)}}(),jr=function(xe){gr(xe)},Sr=function(){return(0,L.jsxs)("ul",{className:"config-left",children:[(0,L.jsx)("li",{className:"menu-item ".concat(Ke===0&&"config-menu-action"),onClick:function(){return jr(0)},children:"\u6784\u5EFA\u6210\u529F\u65F6"}),(0,L.jsx)("li",{className:"menu-item ".concat(Ke===1&&"config-menu-action"),onClick:function(){return jr(1)},children:"\u6784\u5EFA\u5931\u8D25\u65F6"}),(0,L.jsx)("li",{className:"menu-item ".concat(Ke===2&&"config-menu-action"),onClick:function(){return jr(2)},children:"\u6784\u5EFA\u53D6\u6D88\u65F6"})]})},Pr=function(){return(0,L.jsxs)("div",{className:"config-right",children:[(0,L.jsx)("div",{style:{display:Ke===0?"block":"none"},children:(0,L.jsx)(q,{ref:Er,data:Me,type:lr,tabIndex:Ke})}),(0,L.jsx)("div",{style:{display:Ke===1?"block":"none"},children:(0,L.jsx)(q,{ref:dr,data:Me,type:lr,tabIndex:Ke})}),(0,L.jsx)("div",{style:{display:Ke===2?"block":"none"},children:(0,L.jsx)(q,{ref:xr,data:Me,type:lr,tabIndex:Ke})})]})};return(0,L.jsxs)("div",{className:"modify-base-config-container flex-start",children:[Sr(),Pr()]})}var nr=(0,$e.forwardRef)(qr)}}]);
