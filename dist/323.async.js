"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[323],{52610:function(Pe,ge,e){e.d(ge,{$:function(){return H},Y:function(){return ye}});var _=e(68872),H=function(ie){ie.forEach(function(M){M.type=1,M.jobs.forEach(function(E){E.type=2,E.tasks.forEach(function(N){N.type=3})})})},ye=function(){_.ZP.info("\u4EC5\u6F14\u793A\u6D41\u6C34\u7EBF\u589E\u5220\u6539\u67E5\u548C\u6267\u884C\uFF0C\u5176\u4ED6\u6682\u4E0D\u652F\u6301")}},56292:function(Pe,ge,e){e.d(ge,{Ah:function(){return re},E1:function(){return M},G2:function(){return E},IO:function(){return D},JZ:function(){return ce},Ng:function(){return ie},Nu:function(){return N},cD:function(){return m},kc:function(){return L},mZ:function(){return ye}});var _=e(11238),H=function(k){return request("/api/pipeline/config/list",{method:"get",params:k})},ye=function(k){return(0,_.ZP)("/api/pipeline/mine/shortcut/?ordering=-is_global,sort&limit=1000",{method:"get",params:k})},D=function(k){return(0,_.ZP)("/api/pipeline/favorites",{method:"post",data:k})},ie=function(k){return(0,_.ZP)("/api/pipeline/favorites",{method:"delete",data:k})},M=function(k,fe){return(0,_.ZP)("/api/pipeline/mine/shortcut/".concat(k,"/"),{method:"delete",data:fe})},E=function(k){return(0,_.ZP)("/api/pipeline/mine/shortcut/multiple_update/",{method:"put",data:k})},N=function(k){return(0,_.ZP)("/api/pipeline/mine/shortcut/",{method:"post",data:k})},m=function(k){return(0,_.ZP)("/api/pipeline/conf/can_edit",{method:"get",params:k})},ce=function(k,fe){return(0,_.ZP)("/api/pipeline/config/".concat(k,"/json/").concat(fe),{method:"get"})},re=function(k){return(0,_.ZP)("/api/pipeline/config/add",{method:"post",data:k})},L=function(k){return(0,_.ZP)("/api/pipeline/config/".concat(k,"/delete"),{method:"post"})}},2331:function(Pe,ge,e){e.d(ge,{rO:function(){return z},gh:function(){return W}});var _=e(97857),H=e.n(_),ye=e(15009),D=e.n(ye),ie=e(99289),M=e.n(ie),E=e(81492);function N(C,l){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function C(l,t){return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",request("/api/login/",_objectSpread({method:"POST",data:l},t||{})));case 1:case"end":return j.stop()}},C)})),m.apply(this,arguments)}function ce(C,l){return re.apply(this,arguments)}function re(){return re=_asyncToGenerator(_regeneratorRuntime().mark(function C(l,t){return _regeneratorRuntime().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",request("/api/logout/",_objectSpread({method:"POST",data:l},t||{})));case 1:case"end":return j.stop()}},C)})),re.apply(this,arguments)}function L(C){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function C(l){return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",request("/api/system/user/user_info/",_objectSpread({method:"GET"},l||{})));case 1:case"end":return c.stop()}},C)})),U.apply(this,arguments)}function k(C){return fe.apply(this,arguments)}function fe(){return fe=_asyncToGenerator(_regeneratorRuntime().mark(function C(l){return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",request("/api/users/notification",_objectSpread({method:"GET"},l||{})));case 1:case"end":return c.stop()}},C)})),fe.apply(this,arguments)}function K(C){return B.apply(this,arguments)}function B(){return B=M()(D()().mark(function C(l){return D()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,E.W)("/api/system/menu/ext_web_router/",{method:"GET",params:H()({},l)}));case 1:case"end":return c.stop()}},C)})),B.apply(this,arguments)}var d=e(74877),Ce=e(73403),y=e(32319),T=e(53971),Z=e(45742),Q=e(93045),le=e(41156),I=e(56034),J=e(89344),O=e(12119),F=e(86074),V="/user/login",f={originRoutes:[],flatRoutes:[]},W=function(){var C=M()(D()().mark(function l(){var t,c,j,R,s,S,v,i,x,X,p;return D()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=(0,d.ej)("token"),t){r.next=3;break}return r.abrupt("return");case 3:return c=window.location,j=c.search,R=c.pathname,r.prev=4,r.next=7,K();case 7:return s=r.sent,S=s||{},v=S.success,i=v===void 0?!1:v,x=S.data,X=x===void 0?[]:x,p=X||[],f={originRoutes:P(p),flatRoutes:n(p)},r.abrupt("return",f);case 14:r.prev=14,r.t0=r.catch(4),history.replace({pathname:V,search:stringify({redirect:R+j})});case 17:return r.abrupt("return",{});case 18:case"end":return r.stop()}},l,null,[[4,14]])}));return function(){return C.apply(this,arguments)}}(),n=function C(l){l=l&&Array.isArray(l)?l:[l];var t=[];return l.forEach(function(c){var j;t.push(c),(c==null||(j=c.routes)===null||j===void 0?void 0:j.length)>0&&t.push.apply(t,C(c==null?void 0:c.routes))}),t||[]},w={home:(0,F.jsx)(Ce.Z,{}),folder:(0,F.jsx)(y.Z,{}),dashboard:(0,F.jsx)(T.Z,{}),profile:(0,F.jsx)(Z.Z,{}),smile:(0,F.jsx)(Q.Z,{}),appstore:(0,F.jsx)(le.Z,{}),safetyCertificate:(0,F.jsx)(I.Z,{}),"node-expand":(0,F.jsx)(J.Z,{}),key:(0,F.jsx)(O.Z,{})},G=function(l){var t=H()(H()({},l),{},{icon:(l==null?void 0:l.icon)&&w[l.icon]||""});return t},P=function(l){var t=[];return l&&l.length>0&&l.forEach(function(c){var j=G(c);t.push(j)}),t||[]},Y=function(l){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";t=t||window.location.pathname;var c=t.split("/").slice(0,4).join("/");switch(c){case"/FlowLine/created/detail":case"/workflowService/created/detail":t=c;break}var j=f.flatRoutes.find(function(v){return t===(v==null?void 0:v.path)||t===(v==null?void 0:v.path)+"/"}),R=j||{},s=R.permissions,S=s===void 0?[]:s;return S==null?void 0:S.includes(l)},z=function(l,t,c){var j,R=window.location.pathname,s=(0,d.DP)(),S=s.pipelineId,v=s.uuid,i=t||S||v,x=R.split("/").slice(0,4).join("/");switch(x){case"/FlowLine/created/detail":case"/workflowService/created/detail":i=R.split("/")[4],R=x;break}var X=f.flatRoutes.find(function(h){return R===(h==null?void 0:h.path)||R===(h==null?void 0:h.path)+"/"}),p=X||{},a=p.permissions,r=a===void 0?[]:a,b=p.scope,u=b===void 0?[]:b;if(u==="__all__")return!0;u=u||[];var g=u.find(function(h){return h.scope===i})||{permissions:[]};if(c==="menu"&&(g={permissions:r}),g.permissions==="__all__")return!0;var ne=(j=g.permissions)===null||j===void 0?void 0:j.includes(l);return ne}},81492:function(Pe,ge,e){e.d(ge,{Z:function(){return I},W:function(){return le}});var _=e(15009),H=e.n(_),ye=e(97857),D=e.n(ye),ie=e(99289),M=e.n(ie),E=e(11238),N=e(74877),m=e(88026),ce=e(87735),re=e(23279),L=e.n(re),U=(localStorage.getItem("currentLocal")||navigator.language).includes("en"),k=function(){var O=new FormData,F=(0,N.ej)("refresh");O.append("refresh",F);var V=new XMLHttpRequest;V.open("post","/api/token/refresh/",!0),V.send(O),V.onreadystatechange=function(f){var W=V.readyState,n=V.status,w=V.responseText,G=w===void 0?"":w;if(n===401){(0,N.kT)("token"),(0,N.kT)("refresh");var P=m.history.location,Y=P.query,z=Y===void 0?{}:Y,C=P.search,l=P.pathname;console.log("--refresh",z,C,l,m.history.location),m.history.replace({pathname:"/user/login",search:(0,ce.stringify)({redirect:l+C})})}else if(W===4&&n===200){var t=JSON.parse(this.responseText),c=t||{},j=c.success,R=c.data,s=R===void 0?{}:R,S=c.msg;if(!j)return;var v=s||{},i=v.access,x=i===void 0?"":i,X=v.refresh,p=X===void 0?"":X;(0,N.WL)("token",x),(0,N.WL)("refresh",p)}}},fe=L()(k,100),K=e(68872),B={400:"\u53D1\u51FA\u7684\u8BF7\u6C42\u6709\u9519\u8BEF\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u7684\u64CD\u4F5C",401:"\u7528\u6237\u6CA1\u6709\u6743\u9650\uFF08\u4EE4\u724C\u3001\u7528\u6237\u540D\u3001\u5BC6\u7801\u9519\u8BEF\uFF09",403:"\u7528\u6237\u5F97\u5230\u6388\u6743\uFF0C\u4F46\u662F\u8BBF\u95EE\u662F\u88AB\u7981\u6B62\u7684",404:"\u63A5\u53E3\u8D44\u6E90\u4E0D\u5B58\u5728",406:"\u8BF7\u6C42\u7684\u683C\u5F0F\u4E0D\u53EF\u5F97",410:"\u8BF7\u6C42\u7684\u8D44\u6E90\u88AB\u6C38\u4E45\u5220\u9664\uFF0C\u4E14\u4E0D\u4F1A\u518D\u5F97\u5230\u7684",422:"\u5F53\u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C\u53D1\u751F\u4E00\u4E2A\u9A8C\u8BC1\u9519\u8BEF",500:"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668",502:"\u7F51\u5173\u9519\u8BEF",503:"\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u5668\u6682\u65F6\u8FC7\u8F7D\u6216\u7EF4\u62A4",504:"\u7F51\u5173\u8D85\u65F6"},d="",Ce="/user/login",y=window.location.pathname,T=function(O){var F=O.response;if(F&&F.status){var V=B[F.status]||F.statusText,f=F.status,W=F.url;K.ZP.destroy(),K.ZP.warn("\u8BF7\u6C42\u9519\u8BEF".concat(f,": ").concat(W,", ").concat(V),2)}return F},Z=function(){(0,N.kT)("token");var O=m.history.location,F=O.query,V=F===void 0?{}:F,f=O.search,W=O.pathname;m.history.replace({pathname:"/user/login",search:(0,ce.stringify)({redirect:W+f})})},Q=function(){!document.querySelector(".common-login-dlg-show")&&document.querySelector(".common-login-dlg")&&document.querySelector(".common-login-dlg").classList.add("common-login-dlg-show")},le=(0,E.l7)({errorHandler:T,"Cache-Control":"no-cache",credentials:"include"});le.interceptors.request.use(function(){var J=M()(H()().mark(function O(F,V){var f,W,n,w;return H()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(V.headers.language=localStorage.getItem("currentLocal")||navigator.language,d=F,f=(0,N.ej)("token"),W=["/api/login/"],!W.includes(F)){P.next=8;break}f="",P.next=19;break;case 8:if(!(!f&&y!=="loginPath")){P.next=12;break}return P.next=11,Q();case 11:return P.abrupt("return");case 12:if(n=decodeURIComponent(escape(window.atob(f.split(".")[1]))),w=JSON.parse(n).exp,!(w<new Date().getTime().toString().slice(0,10))){P.next=19;break}return V.headers.Authorization="JWT "+f,P.next=18,Q();case 18:return P.abrupt("return");case 19:return V.headers.Authorization=f?"JWT "+f:"",P.abrupt("return",{url:"".concat(F),options:D()({},V)});case 21:case"end":return P.stop()}},O)}));return function(O,F){return J.apply(this,arguments)}}()),le.interceptors.response.use(function(){var J=M()(H()().mark(function O(F,V){var f,W,n,w,G,P,Y,z,C,l,t,c,j,R,s,S;return H()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(f=F||{},W=f.status,n=f.url,w=f.statusText,G=w===void 0?"":w,W===200){i.next=5;break}return K.ZP.destroy(),K.ZP.warn("\u8BF7\u6C42\u9519\u8BEF".concat(W,": ").concat(n,", ").concat(B[F.status]||G),2),i.abrupt("return",Promise.reject("\u8BF7\u6C42\u9519\u8BEF"));case 5:return i.next=7,F.clone().json();case 7:if(i.t0=i.sent,i.t0){i.next=10;break}i.t0={};case 10:if(P=i.t0,Y=document.location.origin,z=["".concat(Y,"/api/reports/submit_check"),"http://px.enflame.cn/api/abi/v2/table/","".concat(Y,"/api/devices/all_class"),"".concat(Y,"/api/devices/all_location"),"".concat(Y,"/api/devices/info/find_user"),"".concat(Y,"/api/tsc/features/sync")],C=["/corporatePartner","/reportManage","/HSE-DVA"],l=n.split("?")[0],t=P||{},c=t.success,j=t.code,R=t.msg,!(!c&&!(z!=null&&z.includes(l)))){i.next=37;break}if(s=window.location.pathname,![401].includes(j)){i.next=30;break}if(K.ZP.destroy(),S=C.some(function(x){return s.startsWith(x)}),!S){i.next=26;break}return i.next=24,Q();case 24:i.next=28;break;case 26:return i.next=28,Z();case 28:i.next=36;break;case 30:if(!(!j&&R==="user not found via provide token")){i.next=35;break}return i.next=33,Q();case 33:i.next=36;break;case 35:R&&(K.ZP.destroy(),K.ZP.warn(R,2));case 36:return i.abrupt("return",Promise.reject(R));case 37:return i.abrupt("return",F);case 38:case"end":return i.stop()}},O)}));return function(O,F){return J.apply(this,arguments)}}());var I=le},70732:function(Pe,ge,e){e.d(ge,{Z:function(){return j}});var _=e(19632),H=e.n(_),ye=e(15009),D=e.n(ye),ie=e(99289),M=e.n(ie),E=e(5574),N=e.n(E),m=e(62435),ce=e(72757),re=e(88026),L=e(7833),U=e.n(L),k=["heading","|","fontSize","|","alignment","|","fontColor","fontBackgroundColor","|","bold","italic","strikethrough","underline","subscript","superscript","|","link","|","outdent","indent","|","bulletedList","numberedList","todoList","|","code","codeBlock","|","insertTable","|","uploadImage","|","blockQuote","|","undo","redo"],fe=["fontSize","bold","italic","fontColor","fontBackgroundColor","bulletedList","numberedList"],K={options:[{model:"paragraph",title:"\u6B63\u6587",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"\u6807\u98981",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"\u6807\u98982",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"\u6807\u98983",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"\u6807\u98984",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"\u6807\u98985",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"\u6807\u98986",class:"ck-heading_heading6"}]},B={options:[12,14,16,18,20,26,30,40]},d=[{color:"#000",label:""},{color:"#4d4d4d",label:""},{color:"#999999",label:""},{color:"#e6e6e6",label:""},{color:"#fff",label:"",hasBorder:!0},{color:"#e64c4c",label:""},{color:"#e6994c",label:""},{color:"#e6e64c",label:""},{color:"#99e64c",label:""},{color:"#4ce64c",label:""},{color:"#4ce699",label:""},{color:"#4ce6e6",label:""},{color:"#4c99e6",label:""},{color:"#4c4ce6",label:""},{color:"#994ce6",label:""}],Ce={colors:d},y={colors:d},T={backgroundColors:d,borderColors:d},Z={backgroundColors:d,borderColors:d},Q=e(11238),le=e(81492),I=Q.ZP.CancelToken,J=I.source(),O=function(){return(0,Q.ZP)("/api/reports/template",{method:"get"})},F=function(s){return(0,Q.ZP)("/api/reports/file_uploader",{method:"post",data:s,timeout:3e4})},V=function(s){return(0,le.W)("/api/reports/template/default",{method:"get",params:s})},f=e(12444),W=e.n(f),n=e(72004),w=e.n(n),G=e(9783),P=e.n(G),Y=e(68872),z=function(){function R(s){W()(this,R),P()(this,"xhr",void 0),P()(this,"loader",void 0),P()(this,"loadingElement",void 0),this.loader=s,this.loadingElement=document.querySelector(".common-editor-upload-loading-container")}return w()(R,[{key:"vaildExt",value:function(S){var v={jpg:!0,jpeg:!0,png:!0,gif:!0,jfif:!0,JPG:!0,JPEG:!0,PNG:!0,JFIF:!0,GIF:!0},i=S.split("."),x=i[i.length-1];return v[x]}},{key:"getImageWidth",value:function(S){return new Promise(function(v,i){var x=new Image;x.src=S,x.onload=function(){v(x.width)}})}},{key:"closeLoading",value:function(){this.loadingElement.style.display="none"}},{key:"openLoading",value:function(){this.loadingElement.style.display="block"}},{key:"upload",value:function(){var S=this;return this.openLoading(),this.loader.file.then(function(v){return new Promise(function(){var i=M()(D()().mark(function x(X,p){var a,r,b,u,g;return D()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(S.vaildExt(v.name)){h.next=5;break}return Y.ZP.error("\u683C\u5F0F\u4EC5\u652F\u6301png\u3001jpg\u3001jpeg\u3001gif"),S.closeLoading(),p(),h.abrupt("return");case 5:if(a=v.size/1024/1024,!(a>5)){h.next=11;break}return Y.ZP.error("\u8BF7\u4E0A\u4F20\u7684\u6587\u4EF6\u5C0F\u4E8E5M"),S.closeLoading(),p(),h.abrupt("return");case 11:return r=new FormData,r.append("file",v),h.prev=13,h.next=16,F(r);case 16:return b=h.sent,h.next=19,S.getImageWidth(b.url);case 19:u=h.sent,g={},g[u]=b.url,X(g),h.next=30;break;case 25:h.prev=25,h.t0=h.catch(13),console.log(h.t0),Y.ZP.error("\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"),p();case 30:return h.prev=30,S.closeLoading(),h.finish(30);case 33:case"end":return h.stop()}},x,null,[[13,25,30,33]])}));return function(x,X){return i.apply(this,arguments)}}())})}},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}}]),R}();function C(R){R.plugins.get("FileRepository").createUploadAdapter=function(s){return new z(s)}}var l=e(74330),t=e(86074),c=function(s,S){var v=(0,re.useIntl)(),i=s.content,x=i===void 0?"":i,X=s.title,p=s.hideTitle,a=p===void 0?!1:p,r=s.onChange,b=s.changeTitle,u=s.disabled,g=u===void 0?!1:u,ne=s.isSimple,h=ne===void 0?!1:ne,ve=(0,m.useState)(null),se=N()(ve,2),je=se[0],$=se[1],he=(0,m.useState)(!1),Se=N()(he,2),Ee=Se[0],Oe=Se[1],Le=(0,m.useState)(""),We=N()(Le,2),He=We[0],we=We[1],$e=(0,m.useState)(""),Ke=N()($e,2),la=Ke[0],ea=Ke[1],aa=(0,m.useState)(!1),pe=N()(aa,2),Re=pe[0],Te=pe[1],Ae=(0,m.useRef)(null),be=(0,m.useRef)(null),De=(0,m.useRef)(null),Ie=(0,m.useRef)({});(0,m.useImperativeHandle)(S,function(){return{getValue:ta,setValue:qe,setTemplateData:Ue}}),(0,m.useEffect)(function(){return Ie.current.pasteImageMap={},function(){}},[]),(0,m.useEffect)(function(){Ye()},[x,je]),(0,m.useEffect)(function(){we(X)},[X,je]),(0,m.useEffect)(function(){be.current&&be.current.editorCK&&(be.current.titleInput=He)},[He,je]);var Ye=function(){var oe=M()(D()().mark(function o(){return D()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:be.current&&be.current.editorCK&&x&&qe(x);case 1:case"end":return q.stop()}},o)}));return function(){return oe.apply(this,arguments)}}(),Ve=function(o){if(o.clipboardData&&o.clipboardData.items){var A=H()(o.clipboardData.items),q=A.find(function(Fe){return Fe.kind==="file"});if(q&&A.length>=2){var ue=q.getAsFile(),de=A.find(function(Fe){return Fe.kind==="string"});de&&de.type.match("^text/html")&&de.getAsString(function(Fe){if(console.log(Fe,"-------------------------"),Fe){var te=Fe.match(/src=".*?"/)[0],xe=te==null?void 0:te.substring(5,te.length-1);console.log(xe),xe.includes(".enflame.cn")&&!xe.includes("10.12.110.200:8080")&&(Ie.current.pasteImageMap[xe]=ue)}})}o.preventDefault()}},ra=function(o){},na=function(){var oe=M()(D()().mark(function o(){var A,q;return D()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,O();case 2:A=de.sent,q=A.data,ea(q.report_template);case 5:case"end":return de.stop()}},o)}));return function(){return oe.apply(this,arguments)}}(),Ue=function(){var oe=M()(D()().mark(function o(){var A,q,ue,de;return D()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.prev=0,te.next=3,V({});case 3:return A=te.sent,q=A.data,te.next=7,ta();case 7:ue=te.sent,de=ue.content,qe((q||"")+de),Y.ZP.success(v.formatMessage({id:"pages.reportManage.templateAddsucc"})),te.next=16;break;case 13:te.prev=13,te.t0=te.catch(0),console.log(te.t0);case 16:case"end":return te.stop()}},o,null,[[0,13]])}));return function(){return oe.apply(this,arguments)}}(),ee=function(o){var A=o.match(/<col\s.*?>/g);return A&&A.forEach(function(q){var ue=q,de=ue.match(/style=".*?;/);de&&(ue="<td ".concat(de[0],'border: none;background-color:#fff;">')),o=o.replace(q,ue)}),o},Me=function(o){return o.replace(/<colgroup /g,'<tr style="background-color: #fff;"').replace(/colgroup>/g,"tr>")},me=function(o){Ae.current.style.display=o?"block":"none"},Ne=function(o){var A,q=document.querySelectorAll(".ck-content img"),ue=/<img.*?>/g,de=(A=o)===null||A===void 0?void 0:A.match(ue);try{return q.forEach(function(Fe,te){var xe=parseInt(getComputedStyle(Fe).width);xe>500&&(xe=500);var ze=decodeURIComponent(Fe.src),Je=Fe.srcset.split(" "),sa=Je[0];Je.length>2&&(sa=Je.slice(0,Je.length-1).join(" "));var Ze='<img src="'.concat(sa||ze,'" sizes="100vw" width="').concat(xe,'">'),oa=/(srcset|src)="(.*?)"/,da=de[te].match(oa)?de[te].match(oa)[2]:"",fa=Fe.srcset||ze;da===fa&&(o=o.replace(de[te],Ze))}),o}catch(Fe){console.log(Fe)}},ta=function(){var oe=M()(D()().mark(function o(){var A,q,ue,de,Fe;return D()().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return ue=(A=be.current)===null||A===void 0?void 0:A.getData(),de=(q=be.current)===null||q===void 0?void 0:q.titleInput,xe.next=4,Xe(ue);case 4:return Fe=xe.sent,xe.abrupt("return",{content:Ne(Fe),title:de});case 6:case"end":return xe.stop()}},o)}));return function(){return oe.apply(this,arguments)}}(),Qe=function(o,A){return new Promise(function(){var q=M()(D()().mark(function ue(de,Fe){var te,xe,ze,Je;return D()().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.prev=0,te=o.file,xe=o.origin,ze=new FormData,ze.append("file",te),Ze.next=6,F(ze);case 6:Je=Ze.sent,de({origin:xe,url:Je.url}),Ze.next=13;break;case 10:Ze.prev=10,Ze.t0=Ze.catch(0),Fe();case 13:case"end":return Ze.stop()}},ue,null,[[0,10]])}));return function(ue,de){return q.apply(this,arguments)}}())},Xe=function(o){return new Promise(function(A){var q,ue,de=[];!((q=Ie.current)===null||q===void 0)&&q.pasteImageMap&&Object.keys((ue=Ie.current)===null||ue===void 0?void 0:ue.pasteImageMap).forEach(function(Fe){var te,xe=(te=Ie.current)===null||te===void 0?void 0:te.pasteImageMap;de.push(Qe({origin:Fe,file:xe[Fe]},o))}),Promise.all(de).then(function(Fe){Fe.forEach(function(te){var xe=te.origin,ze=te.url;o=o.replace(xe,ze)}),A(o)}).catch(function(){A(o)})})},qe=function(o){var A;(A=be.current)===null||A===void 0||A.setData(o)},Be=function(){Oe(!0)},Ge=function(){Oe(!1)},ia=function(o){var A=o.target.value;we(A),b&&b(A)},_e=function(o){var A=o.keyCode,q=o.target;if(A==13){q.blur();var ue=be.current.ui.getEditableElement();ue.focus()}},ke=function(){var oe=M()(D()().mark(function o(){var A;return D()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(A=De.current,A){ue.next=3;break}return ue.abrupt("return");case 3:A.style.height="auto",A.style.height=A.scrollHeight+"px";case 5:case"end":return ue.stop()}},o)}));return function(){return oe.apply(this,arguments)}}(),ua=function(){return(0,t.jsx)("div",{className:"editor-title-input",children:Re?(0,t.jsx)("textarea",{rows:1,placeholder:v.formatMessage({id:"pages.reportManage.reportTitlePlaceholder"}),onFocus:function(){return Be()},ref:De,onBlur:function(){Ge(),Te(!1)},onInput:ke,value:He,onChange:ia,onKeyDown:_e}):(0,t.jsx)("input",{placeholder:v.formatMessage({id:"pages.reportManage.reportTitlePlaceholder"}),onFocus:function(){Be(),Te(!0),setTimeout(function(){De.current.focus(),ke()},100)},onBlur:function(){return Ge()},value:He,onChange:ia,onKeyDown:_e})})},ae=function(o){var A=o.ui.getEditableElement();o.editorCK=!0,o.editorScrollContainer=document.querySelector(".editor-title-input textarea"),be.current=o,$(o),A.addEventListener("scroll",function(){var q=A.scrollTop;try{q>40?be.current.editorScrollContainer.style.display="none":be.current.editorScrollContainer.style.display="block"}catch(ue){}})},ca=function(o,A){var q=A.getData();r&&r(q)};return(0,t.jsxs)("div",{className:"common-editor-wrap",ref:Ie,children:[(0,t.jsx)("div",{className:"common-editor-upload-loading-container",children:(0,t.jsx)("div",{className:"box flex-center",children:(0,t.jsx)(l.Z,{tip:"\u56FE\u7247\u4E0A\u4F20\u4E2D\uFF0C\u8BF7\u52FF\u63D0\u4EA4\u4EE5\u514D\u56FE\u7247\u4E22\u5931",size:"large"})})}),(0,t.jsx)("div",{className:"".concat(!a&&"show-title"),children:(0,t.jsx)(ce.CKEditor,{editor:U(),data:x,disabled:g,config:{removePlugins:["ImageStyle","ImageToolbar","ImageCaption","Title","Code","CodeBlock","Superscript","Subscript"],toolbar:h?fe:k,heading:K,extraPlugins:[C],fontSize:B,fontColor:Ce,fontBackgroundColor:y,table:{tableProperties:T,tableCellProperties:Z}},onReady:function(o){document.querySelector(".ck-content")&&document.querySelector(".ck-content").addEventListener("paste",Ve),ae(o)},onFocus:function(){},onBlur:function(){},onChange:ca,onError:function(o,A){var q=A.willEditorRestart;q&&be.current.ui.view.toolbar.element.remove()},ref:be})}),!a&&ua(),Ee&&(0,t.jsx)("div",{className:"layer"})]})},j=(0,m.forwardRef)(c)},83056:function(Pe,ge,e){e.d(ge,{Q0:function(){return w},YH:function(){return s},r_:function(){return i},C9:function(){return S},Sb:function(){return l},Nv:function(){return Y},ft:function(){return x},Fo:function(){return z},MQ:function(){return C},v4:function(){return G}});var _=e(5574),H=e.n(_),ye=e(19632),D=e.n(ye),ie=e(97857),M=e.n(ie),E=e(30159),N=e(87784),m=e(8751),ce=e(18429),re=e(37446),L=e(48115),U=e(30381),k=e.n(U),fe=e(68872),K=e(77683),B=e(85418),d=e(62435),Ce=e(90222),y=e(4011),T=e(2331),Z=e(74877),Q=Object.defineProperty,le=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,O=(p,a,r)=>a in p?Q(p,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):p[a]=r,F=(p,a)=>{for(var r in a||(a={}))I.call(a,r)&&O(p,r,a[r]);if(le)for(var r of le(a))J.call(a,r)&&O(p,r,a[r]);return p};const V=p=>React.createElement("svg",F({width:24,height:24,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},p),React.createElement("title",null,"Content / CI / Status / Running"),React.createElement("defs",null,React.createElement("path",{id:"loading_svg__a",d:"M0 0h12v14H0z"})),React.createElement("g",{fill:"none",fillRule:"evenodd"},React.createElement("circle",{stroke:"#BED8FF",strokeWidth:4,cx:12,cy:12,r:10}),React.createElement("g",{transform:"translate(12)"},React.createElement("mask",{id:"loading_svg__b",fill:"#fff"},React.createElement("use",{xlinkHref:"#loading_svg__a"})),React.createElement("circle",{stroke:"#2C81FF",strokeWidth:4,mask:"url(#loading_svg__b)",cy:12,r:10}))));var f="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGlkPSJhIiBkPSJNMCAwaDEydjE0SDB6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGNpcmNsZSBzdHJva2U9IiNCRUQ4RkYiIHN0cm9rZS13aWR0aD0iNCIgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIpIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48Y2lyY2xlIHN0cm9rZT0iIzJDODFGRiIgc3Ryb2tlLXdpZHRoPSI0IiBtYXNrPSJ1cmwoI2IpIiBjeT0iMTIiIHI9IjEwIi8+PC9nPjwvZz48L3N2Zz4=",W=e(52610),n=e(86074),w=function(a){return(0,n.jsx)("img",{src:f,className:"flow-created-common-loadingIcon",style:(a==null?void 0:a.style)||{}})},G=function(a){var r=location.pathname.split("/"),b=r[1],u=a.split("/");u[1]=b;var g=u.join("/");return g},P=function(a){switch(a){case"pending":return(0,n.jsx)(E.Z,{style:{color:"#63656e"}});case"running":case"manual_confirm":return(0,n.jsx)(w,{style:{width:"17px"}});case"canceled":return(0,n.jsx)(N.Z,{style:{color:"#f6b026"}});case"skipped":return(0,n.jsx)("i",{className:"iconfont icon-tiaoguofenxiang",style:{color:"#9BABB8",fontSize:"19px"}});case"success":case"pass":return(0,n.jsx)(m.Z,{style:{color:"#4dcb4f"}});case"failed":case"timeout":return(0,n.jsx)(ce.Z,{style:{color:"#e23f3c"}})}},Y=function(a){return(0,n.jsx)("div",{style:{fontSize:"16px"},children:P(a)})},z=function(a){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";switch(a){case void 0:case"":return"";case"MANUAL":case"manual":return(0,n.jsx)("i",{className:"iconfont icon-shoudong"});case"GITLAB_HOOK":return(0,n.jsx)("img",{src:"http://xnas.enflame.cn/dolphin/gitlab-logo-1.svg",style:{width:"16px",display:"inline-block"}});case"GERRIT_HOOK":return(0,n.jsx)("img",{src:"http://xnas.enflame.cn/dolphin/gerrit.png",style:{width:"16px",display:"inline-block"}});case"SCHEDULED":return(0,n.jsx)("i",{className:"iconfont icon-naozhong"});default:return r.includes("GITLAB")||r.includes("gitlab")?(0,n.jsx)("img",{src:"http://xnas.enflame.cn/dolphin/gitlab-logo-1.svg",style:{width:"16px",display:"inline-block"}}):(0,n.jsx)("img",{src:"http://xnas.enflame.cn/dolphin/gerrit.png",style:{width:"16px",display:"inline-block"}})}},C=function(a){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";switch(a){case void 0:case"":return"";case"MANUAL":case"manual":return"\u624B\u52A8\u89E6\u53D1";case"GITLAB_HOOK":return"Gitlab Hook \u89E6\u53D1";case"GERRIT_HOOK":return"Gerrit Hook \u89E6\u53D1";case"SCHEDULED":return"\u5B9A\u65F6\u89E6\u53D1";default:return r.includes("GITLAB")||r.includes("gitlab")?"Gitlab Hook \u89E6\u53D1":"Gerrit Hook \u89E6\u53D1"}},l=function(a){var r=[];return a.forEach(function(b){if(b.prompt_on_trigger){var u={key:b.name,value:b.default,type:b.type,scope:"pipeline",description:b.description};switch(b.type){case"repo":var g=b.repo,ne=a.filter(function(se){return se.type==="repo"}),h=ne.findIndex(function(se){return se.id===b.id}),ve=ne.length-h;r.push({key:"repo_name"+"\uFF08\u4ED3\u5E93".concat(ve,"\uFF09"),name:"\u5168\u5C40",scope:"pipeline",description:g[0]["git_url-description"]||"",type:"repo",value:g[0]["repo-name"]},{key:"repo_url"+"\uFF08\u4ED3\u5E93".concat(ve,"\uFF09"),name:"\u5168\u5C40",scope:"pipeline",description:g[0]["git_url-description"]||"",type:"repo",value:g[0]["repo-url"]}),g[1].patchset&&r.push({key:"patchset"+"\uFF08\u4ED3\u5E93".concat(ve,"\uFF09"),name:"\u5168\u5C40",scope:"pipeline",description:g[1]["ref-description"]||"",type:"repo",value:g[1].patchset}),g[1].ref&&r.push({key:"branch"+"\uFF08\u4ED3\u5E93".concat(ve,"\uFF09"),name:"\u5168\u5C40",scope:"pipeline",description:g[1]["ref-description"]||"",type:"repo",value:g[1].ref}),r.push({key:"commit"+"\uFF08\u4ED3\u5E93".concat(ve,"\uFF09"),name:"\u5168\u5C40",scope:"pipeline",description:g[2]["sha-description"]||"",type:"repo",value:g[2].sha||""});break;case"component":break;case"date":u.value=k()(u.value).format("YYYY-MM-DD HH:mm:ss"),r.push(u);break;default:r.push(u)}}}),r},t=function(a){return a.map(function(r){var b=_objectSpread({},r);return b.display_name&&(b.key="".concat(b.display_name,"\uFF08").concat(b.key,"\uFF09")),b})},c=function(a){if(a.length<=0)return[];var r=a[0].repo_info,b=[];return r?(r.forEach(function(u){var g=[];g.push({key:"repo_name",value:u.base_info.name,displayName:u.base_info.display_name},{key:"repo_url",value:u.base_info.repo_url,displayName:u.base_info.display_name});var ne=u.branch_patchset.type;switch(ne){case"branch":g.push({key:"branch",value:u.branch_patchset.ref,displayName:u.branch_patchset.display_name},{key:"commit",value:u.commit.sha,displayName:u.commit.display_name});break;case"patchset":g.push({key:"patchset",value:u.branch_patchset.patchset,displayName:u.branch_patchset.display_name});break;case"tag":g.push({key:"tag",value:u.branch_patchset.tag,displayName:u.branch_patchset.display_name});break}b.push.apply(b,_toConsumableArray(g.map(function(h){return h.key="\u4ED3\u5E93".concat(u.index).concat(h.displayName?"-".concat(h.displayName):"","\uFF08").concat(h.key,"\uFF09"),h})))}),b):[]},j=function(a){var r=a.value;return typeof r=="boolean"?String(r):r||"-"},R=function(a){var r=a.variables,b=a.varRef,u=a.variableMore,g=a.varableListArrowRef,ne=a.setVariableMore;if(r.length<=0)return _jsx(_Fragment,{});var h=["isBranch"],ve=r.filter(function(he){return!h.includes(he.key)&&!he.repo_info}),se=t(_toConsumableArray(ve)),je=c(r.filter(function(he){return!h.includes(he.key)&&he.repo_info})),$=[].concat(_toConsumableArray(se),_toConsumableArray(je)).filter(function(he){return he.key});return _jsxs("div",{className:"pipeline-detail-varable-list flex-start",children:[_jsx("div",{className:"varable-list-title",children:"\u89E6\u53D1\u53C2\u6570"}),_jsx("ul",{className:"list-varables common-reset",ref:b,style:{height:u?"auto":"18px"},children:$.map(function(he){return _jsx("li",{className:"list-varables-item",children:_jsxs(Tooltip,{overlayClassName:"pipeline-detail-varables-item-tooltip",placement:"topLeft",title:"".concat(he.key,"\uFF1A").concat(String(he.value)||"-"),children:[_jsxs("span",{style:{color:"#7F7F7F",fontWeight:"bold"},children:[he.key,"\uFF1A"]}),j(he)]})})})}),_jsx("div",{ref:g,style:{position:"relative"},children:_jsx("div",{onClick:function(){return ne(!u)},className:"varable-list-arrow flex-center ".concat(u&&"varable-list-arrow-active"),children:_jsx(DownOutlined,{})})})]})},s=function(a){var r=a.data,b=a.uuid,u=a.from,g=a.isAuth,ne=(0,d.useState)([{label:"\u5BFC\u5165\u66F4\u65B0",key:"2"}]),h=H()(ne,2),ve=h[0],se=h[1];(0,d.useEffect)(function(){var Se=location.pathname;Se.includes("/created/modify")||(ve.unshift({label:"\u5BFC\u51FA\u914D\u7F6E",key:"1"}),se(D()(ve)))},[]);var je=(0,d.useRef)(null),$=(0,d.useRef)(null),he=function(Ee){switch(Ee.key){case"1":je.current.open(Ee);break;case"2":if(!(0,T.rO)("Import")){fe.ZP.error("\u6682\u65E0\u6743\u9650");return}$.current.open(Ee);break}};return(0,n.jsxs)(n.Fragment,{children:[u==="add"||(0,T.rO)("More",b)?(0,n.jsx)(n.Fragment,{children:g===!1?(0,n.jsx)(K.ZP,{style:{width:"20px",padding:0,marginLeft:"7px"},disabled:!0,children:(0,n.jsx)(re.Z,{})}):(0,n.jsx)(B.Z,{menu:{items:ve,onClick:W.Y},children:(0,n.jsx)(K.ZP,{disabled:!0,style:{width:"20px",padding:0,marginLeft:"7px"},onClick:function(Ee){return Ee.preventDefault()},children:(0,n.jsx)(re.Z,{})})})}):(0,n.jsx)(K.ZP,{style:{width:"20px",padding:0,marginLeft:"7px"},disabled:!0,children:(0,n.jsx)(re.Z,{})}),(0,n.jsx)(Ce.Z,{ref:je}),(0,n.jsx)(y.Z,M()({ref:$},a))]})},S=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return a.includes("HOOK")||a.includes("hook")?"\u89E6\u53D1\u65B9\u5F0F\u4E3A Hook \uFF0C\u65E0\u6CD5\u624B\u52A8\u89E6\u53D1":""},v=function(a,r){var b=a.taskShow,u=a.setTaskShow,g=a.data,ne=a.setData;(0,d.useImperativeHandle)(r,function(){return{setExpandTask:h}});var h=function(je,$){$===void 0&&($=!0),$=!$,je.stages.forEach(function(he,Se){he.jobs.forEach(function(Ee,Oe){Ee.taskShow=$,je.stages[Se].jobs[Oe].taskShow=$})}),u($)},ve=function(){g.stages.forEach(function(je,$){je.jobs.forEach(function(he,Se){he.taskShow=!b,he.isManualExpand=!0,g.stages[$].jobs[Se].taskShow=!b})}),u(!b),ne(M()({},g))};return(0,n.jsx)("div",{className:"content-tool-box common-flow-Buttoncontent-tool-box flex-start",children:(0,n.jsxs)("div",{className:"flex-start box",onClick:ve,children:[b?"\u5168\u90E8\u5C55\u5F00":"\u5168\u90E8\u6536\u8D77",(0,n.jsx)("div",{className:"common-animation-arrow ".concat(b&&"common-animation-arrow-active"),style:{marginLeft:"3px"},children:(0,n.jsx)(L.Z,{})})]})})},i=(0,d.forwardRef)(v),x=function(a){switch(a){case"success":return(0,n.jsx)("i",{className:"iconfont icon-success-fill step-item-icon-success animation-icon-success",style:{color:"#34d97b"}});case"skipped":return(0,n.jsx)("i",{className:"iconfont icon-tiaoguofenxiang step-item-icon-faild animation-icon-success",style:{color:"#9BABB8"}});case"failed":case"timeout":return(0,n.jsx)("i",{className:"iconfont icon-error-fill step-item-icon-faild",style:{color:"#ff5656"}});case"canceled":return(0,n.jsx)(N.Z,{style:{marginTop:"3px",color:"#f8b300",fontSize:"15px"}})}return(0,n.jsx)(n.Fragment,{})},X=function(a){return _jsx(CopyOutlined,{onClick:function(){return copyText(a)}})}},24031:function(Pe,ge,e){e.d(ge,{Z:function(){return fe}});var _=e(15009),H=e.n(_),ye=e(99289),D=e.n(ye),ie=e(5574),M=e.n(ie),E=e(62435),N=e(96456),m=e(68872),ce=e(81182),re=e(77683),L=e(86074),U=N.Z.TextArea;function k(K){var B=K.item,d=K.form,Ce=K.name,y=K.value,T=(0,E.useState)(y||""),Z=M()(T,2),Q=Z[0],le=Z[1],I=(0,E.useRef)(null);(0,E.useEffect)(function(){d.setFieldValue(Ce,Q)},[Q]);var J=function(w){var G={txt:!0},P=w.split("."),Y=P[P.length-1],z=G[Y];return z||(m.ZP.error("\u4EC5\u652F\u6301 ".concat(Object.keys(G).join("\u3001")," \u683C\u5F0F")),F()),z},O=function(){var n=D()(H()().mark(function w(G){var P,Y,z;return H()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(P=G.target.files[0],J(P.name)){l.next=3;break}return l.abrupt("return");case 3:if(Y=P.size/1024/1024,!(Y>10)){l.next=8;break}return m.ZP.error("\u8BF7\u4E0A\u4F20\u7684\u6587\u4EF6\u5C0F\u4E8E10M"),F(),l.abrupt("return");case 8:z=new FileReader,F(),z.onload=function(t){var c=t.target.result;if(!c){m.ZP.error("\u6587\u4EF6\u4E3A\u7A7A");return}d.setFieldValue(Ce,c),le(c),d.validateFields([Ce])},z.readAsText(P);case 12:case"end":return l.stop()}},w)}));return function(G){return n.apply(this,arguments)}}(),F=function(){var w=I.current;w.value=""},V=function(){return(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:"flex-center",children:(0,L.jsx)("button",{className:"ocr-upload-button",children:"\u4E0A\u4F20\u6587\u4EF6"})}),(0,L.jsx)("p",{className:"ant-upload-text",children:"\u5355\u51FB\u6216\u62D6\u52A8\u5230\u6B64\u533A\u57DF\u4E0A\u4F20\uFF0C\u4EC5\u652F\u6301 txt \u683C\u5F0F\uFF0C\u6587\u4EF6\u5927\u5C0F\u4E0D\u8D85\u8FC710M\u3002"})]})},f=function(){I.current.click()},W=function(){le("")};return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)("div",{className:"common-uploadfile-container variable-file-content-container",children:[(0,L.jsx)("div",{style:{display:y?"block":"none"},children:(0,L.jsxs)("div",{className:"flex-center image-box",style:{alignItems:"flex-start"},children:[(0,L.jsx)(ce.Z.Item,{name:Ce,noStyle:!0,children:(0,L.jsx)(U,{placeholder:"",disabled:!0,className:"flow-var-file-content-text",autoSize:{minRows:3,maxRows:7}})}),"\xA0\xA0",(0,L.jsxs)("div",{className:"flex-center",style:{flexDirection:"column"},children:[(0,L.jsx)(re.ZP,{onClick:function(){return f()},style:{marginBottom:"10px"},children:"\u91CD\u65B0\u4E0A\u4F20"}),(0,L.jsx)(re.ZP,{onClick:function(){return W()},danger:!0,style:{width:"80px"},children:"\u91CD\u7F6E"})]})]})}),(0,L.jsx)("div",{style:{display:y?"none":"block"},children:(0,L.jsxs)("div",{className:"ocr-upload flex-center ",children:[(0,L.jsx)("input",{type:"file",name:"file",id:"file",ref:I,accept:".txt",className:"ocr-upload-input",onChange:O}),V()]})})]})})}var fe=k},81470:function(Pe,ge,e){e.d(ge,{Z:function(){return T}});var _=e(15009),H=e.n(_),ye=e(99289),D=e.n(ye),ie=e(5574),M=e.n(ie),E=e(62435),N=e(94060),m=e(74330),ce=e(32983),re=e(81182),L=e(78045),U=e(11238),k=function(Q){return(0,U.ZP)("/api/pipeline/variables/branch",{method:"get",params:Q})},fe=function(Q){return(0,U.ZP)("/api/pipeline/variables/gerrit_ref",{method:"get",params:Q})},K=e(23279),B=e.n(K),d=e(86074),Ce=N.Z.Option;function y(Z,Q){var le=Z.label,I=Z.name,J=Z.initialValue,O=Z.repoType,F=Z.change,V=Z.required,f=V===void 0?!0:V,W=Z.message,n=Z.repoId,w=Z.className,G=Z.style,P=Z.isBranch,Y=Z.onSwitchBranchChange,z=Z.patchsetName,C=Z.isBranchValue,l=Z.id,t=Z.repoName,c=Z.from,j=Z.help,R=j===void 0?"":j,s=Z.isVaildBranch,S=s===void 0?!1:s,v=Z.presetChange,i=v===void 0?function(){}:v,x=Z.searchChange,X=Z.currentDefaultValue,p=(0,E.useState)(!1),a=M()(p,2),r=a[0],b=a[1],u=(0,E.useState)([]),g=M()(u,2),ne=g[0],h=g[1],ve=(0,E.useState)([]),se=M()(ve,2),je=se[0],$=se[1],he=(0,E.useRef)(null),Se=!1,Ee=!1;(0,E.useEffect)(function(){t&&(O==="gerrit"?Le("",C===void 0||C===!0?"branch":"refId"):Le("","branch"))},[n,t,C,O]),(0,E.useImperativeHandle)(Q,function(){return{setOptionsData:Oe}});var Oe=function(Re){h([]),$([])},Le=function(){var pe=D()(H()().mark(function Re(){var Te,Ae,be,De,Ie,Ye,Ve,ra,na,Ue,ee=arguments;return H()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(Te=ee.length>0&&ee[0]!==void 0?ee[0]:"",Ae=ee.length>1&&ee[1]!==void 0?ee[1]:"branch",be={branch:h,refId:$},De=be[Ae],n){me.next=7;break}return De([]),me.abrupt("return");case 7:if(Ie={branch:Se,refId:Ee},Ye=Ie[Ae],!Ye){me.next=11;break}return me.abrupt("return");case 11:return Ie[Ae]=!0,b(!0),De([]),Ve={type:O,repo_id:n},Ae==="refId"?(Ve.repo_name=t,Ve.ref_id=Te):Ve.branch=Te,me.prev=16,ra=Ae==="refId"?fe:k,me.next=20,ra(Ve);case 20:na=me.sent,Ue=na.data,x&&x(Te,Ue,Ae),De(Ue),me.next=28;break;case 26:me.prev=26,me.t0=me.catch(16);case 28:return me.prev=28,setTimeout(function(){Ie[Ae]=!1,b(!1)},1500),me.finish(28);case 31:case"end":return me.stop()}},Re,null,[[16,26,28,31]])}));return function(){return pe.apply(this,arguments)}}(),We=function(){return we()?I:z},He=function(){var Re=we()?"\u8BF7\u586B\u5199\u5206\u652F":"\u8BF7\u586B\u5199 Patchset";return Re},we=function(){return O==="gerrit"?C===void 0||C===!0:!0},$e=B()(function(pe){return Le(pe,"branch")},500),Ke=B()(function(pe){return Le(pe,"refId")},500),la=B()(function(pe){console.log("222222222222")},1e3),ea=(0,E.useMemo)(function(){return(0,d.jsx)(N.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u4EE3\u7801\u5206\u652F\uFF0C\u652F\u6301\u6A21\u7CCA\u67E5\u8BE2",showSearch:!0,optionFilterProp:"children",filterOption:!1,onSearch:$e,notFoundContent:r?(0,d.jsx)(m.Z,{size:"small"}):(0,d.jsx)(ce.Z,{}),onChange:F,children:ne.map(function(pe){return(0,d.jsx)(Ce,{value:pe,label:pe,children:pe})})})},[n,t,C,ne,r,O]),aa=(0,E.useMemo)(function(){return(0,d.jsx)(N.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165 Patchset \uFF0C\u652F\u6301\u6A21\u7CCA\u67E5\u8BE2",showSearch:!0,optionFilterProp:"children",filterOption:!1,onSearch:Ke,notFoundContent:r?(0,d.jsx)(m.Z,{size:"small"}):(0,d.jsx)(ce.Z,{}),onChange:i,style:{width:"calc(100% )"},children:je.map(function(pe){return(0,d.jsx)(Ce,{value:pe.ref_id,label:pe.ref_id,title:"".concat(pe.title,`
`).concat(pe.ref_id),children:(0,d.jsxs)("div",{children:[pe.ref_id,"\uFF1A",pe.title]})})})})},[n,t,C,je,r,O]);return(0,d.jsx)("div",{ref:he,className:w+" environmentVariable-form-branch-container",style:G,children:(0,d.jsx)(re.Z.Item,{required:f,label:le,help:R,children:(0,d.jsxs)("div",{className:"flex-start",style:{alignItems:"flex-start"},children:[f&&(0,d.jsx)("div",{style:{color:"#ff4d4f",marginRight:"5px",marginTop:"7px"},children:"*"}),O==="gerrit"&&(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{style:{width:"170px"},className:"flex-start",children:(0,d.jsx)(re.Z.Item,{label:"",name:P,style:{margin:0},children:(0,d.jsx)(L.ZP.Group,{options:[{label:"Patchset",value:!1},{label:"\u4EE3\u7801\u5206\u652F",value:!0}],optionType:"button",defaultValue:!1,onChange:function(Re){return Y(Re.target.value,P,l)}})})})}),(0,d.jsx)("div",{className:"form-branch-right-box-width ".concat(O!=="gerrit"&&"now-form-branch-box"),children:we()?(0,d.jsx)(re.Z.Item,{name:I,rules:[{required:f,message:"\u8BF7\u9009\u62E9\u5206\u652F"}],initialValue:J,children:ea}):(0,d.jsx)(re.Z.Item,{name:z,rules:[{required:f,message:"\u8BF7\u9009\u62E9 Patchset"}],children:aa})})]})})})}var T=(0,E.forwardRef)(y)},34084:function(Pe,ge,e){e.d(ge,{Z:function(){return Ce}});var _=e(15009),H=e.n(_),ye=e(99289),D=e.n(ye),ie=e(5574),M=e.n(ie),E=e(62435),N=e(94060),m=e(81182),ce=e(74330),re=e(32983),L=e(11238),U=function(T){return(0,L.ZP)("/api/pipeline/variables/repo",{method:"get",params:T})},k=e(23279),fe=e.n(k),K=e(86074),B=N.Z.Option;function d(y,T){var Z=y.label,Q=y.name,le=y.initialValue,I=y.repoType,J=y.repoChange,O=y.required,F=y.message,V=y.className,f=y.style,W=y.help,n=W===void 0?"":W,w=(0,E.useState)(!1),G=M()(w,2),P=G[0],Y=G[1],z=(0,E.useState)([]),C=M()(z,2),l=C[0],t=C[1];(0,E.useImperativeHandle)(T,function(){return{setOptionsData:c,getRepoApi:j}}),(0,E.useEffect)(function(){j()},[]);var c=function(S){t([])},j=function(){var s=D()(H()().mark(function S(){var v,i,x,X,p=arguments;return H()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return v=p.length>0&&p[0]!==void 0?p[0]:"",Y(!0),t([]),i={type:I,repo_name:v},v||(i.default=le),r.prev=5,r.next=8,U(i);case 8:x=r.sent,X=x.data,t(X),r.next=15;break;case 13:r.prev=13,r.t0=r.catch(5);case 15:return r.prev=15,Y(!1),r.finish(15);case 18:case"end":return r.stop()}},S,null,[[5,13,15,18]])}));return function(){return s.apply(this,arguments)}}(),R=fe()(j,500);return(0,K.jsx)(m.Z.Item,{label:Z,name:Q,initialValue:le,rules:[{required:O,message:F}],extra:n?(0,K.jsx)("span",{dangerouslySetInnerHTML:{__html:n}}):"",className:V,style:f,children:(0,K.jsx)(N.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u4ED3\u5E93\u540D\u79F0\uFF0C\u652F\u6301\u6A21\u7CCA\u67E5\u8BE2",showSearch:!0,filterOption:!1,onSearch:function(S){return R(S)},notFoundContent:P?(0,K.jsx)(ce.Z,{size:"small"}):(0,K.jsx)(re.Z,{}),onChange:function(S){var v=l.find(function(i){return i.id===S});J(v)},children:l.map(function(s){return(0,K.jsx)(B,{value:s.id,label:s.name,children:s.name})})})})}var Ce=(0,E.forwardRef)(d)},70646:function(Pe,ge,e){e.d(ge,{Z:function(){return Ce}});var _=e(15009),H=e.n(_),ye=e(99289),D=e.n(ye),ie=e(5574),M=e.n(ie),E=e(62435),N=e(68872),m=e(50888),ce=e(2068),re=e(99611),L=e(48689),U=e(74877),k=e(11238),fe=function(T){return request("/api/test",{method:"get",params:T})},K=function(T){return(0,k.ZP)("/api/reports/file_uploader",{method:"post",data:T})},B=e(86074);function d(y,T){var Z=y.update,Q=Z===void 0?function(){}:Z,le=y.disabled,I=le===void 0?!1:le,J=y.styleType,O=J===void 0?1:J,F=y.getImageUrl,V=F===void 0?function(){}:F,f=y.img,W=(0,E.useState)(),n=M()(W,2),w=n[0],G=n[1],P=(0,U.DP)(),Y=(0,E.useState)(!1),z=M()(Y,2),C=z[0],l=z[1],t=(0,E.useState)(""),c=M()(t,2),j=c[0],R=c[1],s=(0,E.useRef)(null);(0,E.useEffect)(function(){if(f){var u=f.split("/"),g=u[u.length-1].split("_");g.shift(),R(g.join(""))}},[f]),(0,E.useImperativeHandle)(T,function(){return{getImage:x,setImage:i,checkUploading:S}}),(0,E.useEffect)(function(){G(f)},[f]);var S=function(){return console.log(C),C},v=function(){window.open(w)},i=function(g){G(g)},x=function(){return w},X=function(){P.view!=="1"&&(G(""),V(""),Q())},p=function(){var g=s.current;g.value="",l(!1)},a=function(g){var ne={csv:!0,txt:!0,xlsx:!0,pdf:!0},h=g.split("."),ve=h[h.length-1],se=ne[ve];return se||(N.ZP.error("\u4EC5\u652F\u6301 ".concat(Object.keys(ne).join("\u3001")," \u683C\u5F0F")),p()),se},r=function(){var u=D()(H()().mark(function g(){var ne,h,ve,se;return H()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(!C){$.next=3;break}return N.ZP.error("\u8BF7\u4E0D\u8981\u91CD\u590D\u4E0A\u4F20"),$.abrupt("return");case 3:if(l(!0),ne=s.current.files[0],ne){$.next=8;break}return l(!1),$.abrupt("return");case 8:if(a(ne.name)){$.next=10;break}return $.abrupt("return");case 10:if(h=ne.size/1024/1024,!(h>10)){$.next=15;break}return N.ZP.error("\u8BF7\u4E0A\u4F20\u7684\u6587\u4EF6\u5C0F\u4E8E10M"),p(),$.abrupt("return");case 15:return R(ne.name),$.prev=16,ve=new FormData,ve.append("file",ne),$.next=21,K(ve);case 21:se=$.sent,G(se.url),V(se.url),l(!1),Q(),$.next=33;break;case 28:$.prev=28,$.t0=$.catch(16),N.ZP.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20.."),p(),Q();case 33:case"end":return $.stop()}},g,null,[[16,28]])}));return function(){return u.apply(this,arguments)}}(),b=function(){switch(O){default:return(0,B.jsxs)("div",{children:[(0,B.jsx)("div",{className:"flex-center",children:(0,B.jsx)("button",{className:"ocr-upload-button",children:C?(0,B.jsxs)("span",{children:[(0,B.jsx)(m.Z,{})," \u4E0A\u4F20\u4E2D..."]}):"\u4E0A\u4F20\u6587\u4EF6"})}),(0,B.jsx)("p",{className:"ant-upload-text",children:"\u5355\u51FB\u6216\u62D6\u52A8\u5230\u6B64\u533A\u57DF\u4E0A\u4F20\uFF0C\u652F\u6301 txt\u3001xlsx\u3001pdf\u3001csv \u683C\u5F0F\uFF0C\u6587\u4EF6\u5927\u5C0F\u4E0D\u8D85\u8FC710M\u3002"})]})}};return(0,B.jsx)("div",{className:"common-uploadfile-container",children:w?(0,B.jsxs)("div",{className:"flex-center image-box",children:[(0,B.jsxs)("div",{style:{textAlign:"center"},children:[(0,B.jsx)(ce.Z,{style:{fontSize:"50px",marginBottom:"10px"}}),(0,B.jsx)("div",{children:j})]}),(0,B.jsx)("div",{className:"image-layer flex-center",children:(0,B.jsxs)("div",{children:[(0,B.jsx)(re.Z,{style:{fontSize:"20px"},onClick:function(){return v()}}),!I&&(0,B.jsxs)(B.Fragment,{children:["\xA0\xA0\xA0",(0,B.jsx)(L.Z,{style:{fontSize:"20px"},onClick:function(){return X()}})]})]})})]}):(0,B.jsxs)("div",{className:"ocr-upload flex-center ".concat(O===2&&"common-upload-style-2"," ").concat(I&&"disabled-upload"),children:[(0,B.jsx)("input",{type:"file",name:"file",id:"file",ref:s,accept:".txt,.xlsx,.pdf,.csv",className:"ocr-upload-input",onChange:r,disabled:I||C}),b()]})})}var Ce=(0,E.forwardRef)(d)},90222:function(Pe,ge,e){e.d(ge,{Z:function(){return T}});var _=e(15009),H=e.n(_),ye=e(99289),D=e.n(ye),ie=e(5574),M=e.n(ie),E=e(62435),N=e(96456),m=e(81182),ce=e(68872),re=e(59259),L=e(77683),U=e(81492),k=function(Q){return request("/api/test",{method:"get",params:Q})},fe=function(Q,le){return(0,U.Z)("/api/pipeline/config/".concat(Q,"/json/").concat(le),{method:"get"})},K=e(74877),B=e(96974),d=e(86074),Ce=N.Z.TextArea;function y(Z,Q){var le=(0,E.useState)(!1),I=M()(le,2),J=I[0],O=I[1],F=(0,E.useState)({}),V=M()(F,2),f=V[0],W=V[1],n=(0,K.DP)(),w=(0,B.UO)()||{},G=w.pipelineId,P=(0,E.useRef)(null),Y=m.Z.useForm(),z=M()(Y,1),C=z[0];(0,E.useImperativeHandle)(Q,function(){return{open:l}});var l=function(S){W(S),O(!0)},t=function(){O(!1)},c=function(){var s=D()(H()().mark(function S(){var v;return H()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,C.validateFields();case 2:v=x.sent;case 3:case"end":return x.stop()}},S)}));return function(){return s.apply(this,arguments)}}(),j=function(S,v){var i=document.createElement("a");i.href=URL.createObjectURL(S),i.download="".concat(v.name,".json"),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),ce.ZP.success("\u5BFC\u51FA\u6210\u529F"),t()},R=function(){var s=D()(H()().mark(function S(){var v,i,x,X;return H()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,v=G||n.pipelineId||f.uuid,a.next=4,fe(v,0);case 4:i=a.sent,x=i.data,X=new Blob([JSON.stringify(x,null,2)],{type:"application/json;charset=utf-8"}),j(X,x),a.next=12;break;case 10:a.prev=10,a.t0=a.catch(0);case 12:case"end":return a.stop()}},S,null,[[0,10]])}));return function(){return s.apply(this,arguments)}}();return(0,d.jsx)("div",{ref:P,children:(0,d.jsx)(re.Z,{title:"\u5BFC\u51FA\u914D\u7F6E",centered:!0,destroyOnClose:!0,footer:[],open:J,onCancel:t,className:"flow-created-detail-export-container",children:(0,d.jsxs)("div",{className:"export-box",children:[(0,d.jsx)("div",{className:"export-icon",children:(0,d.jsx)("i",{className:"iconfont icon-logo-pipeline"})}),(0,d.jsx)("p",{style:{textAlign:"center",margin:"10px",fontSize:"18px",fontWeight:"bold",color:"#63656e"},children:"Pipeline Json"}),(0,d.jsx)("p",{children:"\u901A\u8FC7\u5BFC\u5165\u529F\u80FD\uFF0C\u53EF\u4EE5\u5FEB\u901F\u521B\u5EFA\u6D41\u6C34\u7EBF\uFF0C\u4E5F\u53EF\u4EE5\u5B9E\u73B0\u8DE8\u9879\u76EE\u3001\u8DE8\u5E73\u53F0\u73AF\u5883\u7684\u6D41\u6C34\u7EBF\u5BFC\u5165\u3002"}),(0,d.jsx)(L.ZP,{className:"button",onClick:function(){return R()},children:"\u5BFC\u51FA"})]})})})}var T=(0,E.forwardRef)(y)},4011:function(Pe,ge,e){e.d(ge,{Z:function(){return I}});var _=e(97857),H=e.n(_),ye=e(5574),D=e.n(ye),ie=e(62435),M=e(96456),E=e(81182),N=e(59259),m=e(74877),ce=e(96974),re=e(15009),L=e.n(re),U=e(99289),k=e.n(U),fe=e(19632),K=e.n(fe),B=e(68872),d=e(88026),Ce=e(83056),y=e(86074);function T(J){var O=J.value,F=J.onCancel,V=J.record,f=(0,ie.useRef)(null),W=(0,ie.useRef)(""),n=(0,ce.UO)()||{},w=n.pipelineId,G=E.Z.useForm(),P=D()(G,1),Y=P[0],z=(0,d.useSelector)(function(v){var i=v.pipeline;return i}),C=(0,d.useDispatch)(),l=(0,m.DP)(),t=function(i){var x={json:!0},X=i.split("."),p=X[X.length-1],a=x[p];return a||(B.ZP.error("\u4EC5\u652F\u6301 ".concat(Object.keys(x).join("\u3001")," \u683C\u5F0F")),R()),a},c=function(){var i=W.current;C({type:"pipeline/setList",payload:{list:K()(z.list),importData:JSON.parse(i)}});var x=w||l.pipelineId||V.uuid;J.history.push((0,Ce.v4)("/FlowLine/created/modify?pipelineId=".concat(x,"&tab=1&source=import&t=").concat(Date.now()))),B.ZP.success("\u5BFC\u5165\u6210\u529F"),setTimeout(function(){F()},500)},j=function(){var v=k()(L()().mark(function i(x){var X,p,a;return L()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(X=x.target.files[0],t(X.name)){b.next=3;break}return b.abrupt("return");case 3:if(p=X.size/1024/1024,!(p>10)){b.next=8;break}return B.ZP.error("\u8BF7\u4E0A\u4F20\u7684\u6587\u4EF6\u5C0F\u4E8E10M"),R(),b.abrupt("return");case 8:a=new FileReader,R(),a.onload=function(){var u=k()(L()().mark(function g(ne){var h;return L()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return h=ne.target.result,W.current=h,se.next=4,Y.validateFields();case 4:c();case 5:case"end":return se.stop()}},g)}));return function(g){return u.apply(this,arguments)}}(),a.readAsText(X);case 12:case"end":return b.stop()}},i)}));return function(x){return v.apply(this,arguments)}}(),R=function(){var i=f.current;i.value=""},s=function(i,x){try{var X=JSON.parse(W.current);if(!X.setting||!X.stages)return Promise.reject("\u8BE5\u6587\u4EF6\u914D\u7F6E\u65E0\u6548")}catch(p){return Promise.reject("\u683C\u5F0F\u9519\u8BEF")}return Promise.resolve()},S=function(){return(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"flex-center",children:(0,y.jsx)("button",{className:"ocr-upload-button",children:"\u4E0A\u4F20\u6587\u4EF6"})}),(0,y.jsx)("p",{className:"ant-upload-text",children:"\u5355\u51FB\u6216\u62D6\u52A8\u5230\u6B64\u533A\u57DF\u4E0A\u4F20\uFF0C\u4EC5\u652F\u6301 json \u683C\u5F0F\uFF0C\u6587\u4EF6\u5927\u5C0F\u4E0D\u8D85\u8FC710M\u3002"})]})};return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("div",{className:"common-uploadfile-container variable-file-content-container",children:(0,y.jsx)(E.Z,{form:Y,name:"control-hooks",layout:"vertical",children:(0,y.jsx)(E.Z.Item,{name:"content",label:"",rules:[{validator:s}],children:(0,y.jsx)("div",{children:(0,y.jsxs)("div",{className:"ocr-upload flex-center ",children:[(0,y.jsx)("input",{type:"file",name:"file",id:"file",ref:f,accept:".json",className:"ocr-upload-input",onChange:j}),S()]})})})})})})}var Z=T,Q=M.Z.TextArea;function le(J,O){var F=(0,ie.useState)(!1),V=D()(F,2),f=V[0],W=V[1],n=(0,ie.useState)({}),w=D()(n,2),G=w[0],P=w[1],Y=(0,m.DP)(),z=(0,ce.UO)()||{},C=z.pipelineId,l=(0,ie.useRef)(null),t=E.Z.useForm(),c=D()(t,1),j=c[0];(0,ie.useImperativeHandle)(O,function(){return{open:R}});var R=function(v){P(v),W(!0)},s=function(){W(!1)};return(0,y.jsx)("div",{ref:l,children:(0,y.jsxs)(N.Z,{title:"\u5BFC\u5165\u66F4\u65B0",centered:!0,destroyOnClose:!0,footer:[],open:f,onCancel:s,className:"flow-created-detail-import-container",children:[(0,y.jsx)("div",{className:"import-box",children:(0,y.jsx)("div",{children:"\u8BF7\u4E0A\u4F20\u4E00\u4E2A\u6D41\u6C34\u7EBF JSON \u6587\u4EF6"})}),(0,y.jsx)(Z,H()(H()({},J),{},{onCancel:s,record:G}))]})})}var I=(0,ie.forwardRef)(le)},63103:function(Pe,ge,e){e.d(ge,{Z:function(){return le}});var _=e(15009),H=e.n(_),ye=e(99289),D=e.n(ye),ie=e(19632),M=e.n(ie),E=e(5574),N=e.n(E),m=e(62435),ce=e(94060),re=e(74330),L=e(32983),U=e(81182),k=e(78045),fe=e(11238),K=function(J){return(0,fe.ZP)("/api/pipeline/variables/branch",{method:"get",params:J})},B=function(J){return(0,fe.ZP)("/api/pipeline/variables/gerrit_ref",{method:"get",params:J})},d=function(J){return(0,fe.ZP)("/api/pipeline/variables/tags",{method:"get",params:J})},Ce=e(23279),y=e.n(Ce),T=e(86074),Z=ce.Z.Option;function Q(I,J){var O=I.label,F=I.name,V=I.initialValue,f=I.repoType,W=I.change,n=I.required,w=n===void 0?!0:n,G=I.repoId,P=I.className,Y=I.style,z=I.isBranch,C=I.onSwitchBranchChange,l=I.patchsetName,t=I.isBranchValue,c=I.id,j=I.repoName,R=I.help,s=R===void 0?"":R,S=I.presetChange,v=S===void 0?function(){}:S,i=I.searchChange,x=I.form,X=I.tagName,p=I.detailVal,a=p===void 0?{}:p,r=(0,m.useState)(!1),b=N()(r,2),u=b[0],g=b[1],ne=(0,m.useState)([]),h=N()(ne,2),ve=h[0],se=h[1],je=(0,m.useState)([]),$=N()(je,2),he=$[0],Se=$[1],Ee=(0,m.useState)([]),Oe=N()(Ee,2),Le=Oe[0],We=Oe[1],He=(0,m.useState)([]),we=N()(He,2),$e=we[0],Ke=we[1],la=(0,m.useRef)(null),ea=!1,aa=!1,pe=!1;(0,m.useEffect)(function(){f&&(f==="gerrit"?($e=[{label:"Patchset",value:"patchset"},{label:"\u4EE3\u7801\u5206\u652F",value:"branch"},{label:"Tag",value:"tag"}],t===void 0&&x.setFieldValue(z,"patchset")):($e=[{label:"\u4EE3\u7801\u5206\u652F",value:"branch"},{label:"Tag",value:"tag"}],t===void 0&&x.setFieldValue(z,"branch")),Ke(M()($e)))},[f,a]),(0,m.useEffect)(function(){j&&Te("",t)},[G,j,t,f]),(0,m.useImperativeHandle)(J,function(){return{setOptionsData:Re}});var Re=function(Me){se([]),Se([]),We([])},Te=function(){var ee=D()(H()().mark(function Me(){var me,Ne,ta,Qe,Xe,qe,Be,Ge,ia,_e,ke=arguments;return H()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(me=ke.length>0&&ke[0]!==void 0?ke[0]:"",Ne=ke.length>1&&ke[1]!==void 0?ke[1]:"branch",ta={branch:se,patchset:Se,tag:We},Qe=ta[Ne]||function(){},G){ae.next=7;break}return Qe([]),ae.abrupt("return");case 7:if(Xe={branch:ea,patchset:aa,tag:pe},qe=Xe[Ne],!qe){ae.next=11;break}return ae.abrupt("return");case 11:Xe[Ne]=!0,g(!0),Qe([]),Be={type:f,repo_id:G},ae.t0=Ne,ae.next=ae.t0==="patchset"?18:ae.t0==="branch"?21:ae.t0==="tag"?23:26;break;case 18:return Be.repo_name=j,Be.ref_id=me,ae.abrupt("break",26);case 21:return Be.branch=me,ae.abrupt("break",26);case 23:return Be.repo_name=j,Be.search_by=me,ae.abrupt("break",26);case 26:ae.prev=26,Ge="",ae.t1=Ne,ae.next=ae.t1==="patchset"?31:ae.t1==="branch"?33:ae.t1==="tag"?35:37;break;case 31:return Ge=B,ae.abrupt("break",37);case 33:return Ge=K,ae.abrupt("break",37);case 35:return Ge=d,ae.abrupt("break",37);case 37:return ae.next=39,Ge(Be);case 39:ia=ae.sent,_e=ia.data,i&&i(me,_e,Ne),Qe(_e),ae.next=47;break;case 45:ae.prev=45,ae.t2=ae.catch(26);case 47:return ae.prev=47,setTimeout(function(){Xe[Ne]=!1,g(!1)},1500),ae.finish(47);case 50:case"end":return ae.stop()}},Me,null,[[26,45,47,50]])}));return function(){return ee.apply(this,arguments)}}(),Ae=function(){return f==="gerrit"?"patchset":"branch"},be=y()(function(ee){return Te(ee,"branch")},500),De=y()(function(ee){return Te(ee,"tag")},500),Ie=y()(function(ee){return Te(ee,"patchset")},500),Ye=function(Me){var me=Me.target.value;x.setFieldValue(z,me),C(me,z,c)},Ve=y()(function(ee){console.log("222222222222")},1e3),ra=(0,m.useMemo)(function(){return(0,T.jsx)(ce.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165\u4EE3\u7801\u5206\u652F\uFF0C\u652F\u6301\u6A21\u7CCA\u67E5\u8BE2",showSearch:!0,optionFilterProp:"children",filterOption:!1,onSearch:be,notFoundContent:u?(0,T.jsx)(re.Z,{size:"small"}):(0,T.jsx)(L.Z,{}),onChange:W,children:ve.map(function(ee){return(0,T.jsx)(Z,{value:ee,label:ee,children:ee})})})},[G,j,t,ve,u,f]),na=(0,m.useMemo)(function(){return(0,T.jsx)(ce.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165 Tag \uFF0C\u652F\u6301\u6A21\u7CCA\u67E5\u8BE2",showSearch:!0,optionFilterProp:"children",filterOption:!1,onSearch:De,notFoundContent:u?(0,T.jsx)(re.Z,{size:"small"}):(0,T.jsx)(L.Z,{}),onChange:W,children:Le.map(function(ee){return(0,T.jsx)(Z,{value:ee.name,children:ee.name})})})},[G,j,t,Le,u,f]),Ue=(0,m.useMemo)(function(){return(0,T.jsx)(ce.Z,{allowClear:!0,placeholder:"\u8BF7\u8F93\u5165 Patchset \uFF0C\u652F\u6301\u6A21\u7CCA\u67E5\u8BE2",showSearch:!0,optionFilterProp:"children",filterOption:!1,onSearch:Ie,notFoundContent:u?(0,T.jsx)(re.Z,{size:"small"}):(0,T.jsx)(L.Z,{}),onChange:v,style:{width:"calc(100% )"},children:he.map(function(ee){return(0,T.jsx)(Z,{value:ee.ref_id,label:ee.ref_id,title:"".concat(ee.title,`
`).concat(ee.ref_id),children:(0,T.jsxs)("div",{children:[ee.ref_id,"\uFF1A",ee.title]})})})})},[G,j,t,he,u,f]);return(0,T.jsx)("div",{ref:la,className:P+" environmentVariable-form-branch-container preview-environmentVariable-branch-container",style:Y,children:(0,T.jsx)(U.Z.Item,{required:w,label:O,extra:s,children:(0,T.jsxs)("div",{className:"flex-start",style:{alignItems:"flex-start"},children:[(0,T.jsx)("div",{style:{width:f==="gerrit"?"225px":"197px"},className:"flex-start",children:(0,T.jsx)(U.Z.Item,{label:"",name:z,style:{margin:0},initialValue:"branch",children:(0,T.jsx)(k.ZP.Group,{options:$e,optionType:"button",defaultValue:!1,onChange:function(Me){return Ye(Me)}})})}),(0,T.jsxs)("div",{className:"form-branch-right-box-width ".concat(f!=="gerrit"&&"now-form-branch-box"),children:[t==="patchset"&&(0,T.jsx)(U.Z.Item,{name:l,rules:[{required:w,message:"\u8BF7\u9009\u62E9 Patchset"}],children:Ue}),t==="branch"&&(0,T.jsx)(U.Z.Item,{name:F,rules:[{required:w,message:"\u8BF7\u9009\u62E9\u5206\u652F"}],initialValue:V,children:ra}),t==="tag"&&(0,T.jsx)(U.Z.Item,{name:X,rules:[{required:w,message:"\u8BF7\u9009\u62E9 Tag"}],children:na})]})]})})})}var le=(0,m.forwardRef)(Q)}}]);
